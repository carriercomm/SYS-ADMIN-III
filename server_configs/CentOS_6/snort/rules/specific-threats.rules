# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2012 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2012 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#------------------------
# SPECIFIC-THREATS RULES
#------------------------


alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS Adobe RoboHelp r0 SQL injection attempt"; flow:to_server,established; content:"Help_Errors.asp"; nocase; http_uri; pcre:"/\x26r0\x3d\d*[^\x26\s\d]/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-2991; classtype:web-application-attack; sid:13928; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><name>"; distance:0; http_client_body; content:"'|29 3B|echo|28|'"; distance:0; http_client_body; content:"'|29 3B| passthru|28|chr|28|"; distance:0; http_client_body; metadata:policy security-ips drop, service http; reference:cve,2005-1921; classtype:attempted-admin; sid:13816; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS alternate xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><value><string></string></value></param><param><value><string>"; distance:0; http_client_body; content:"AND ascii|28|substring|28|pass,1,1|29 29 0A|/**/BETWEEN/**/52/**/AND/**/58|29|/*"; http_client_body; metadata:policy security-ips drop, service http; reference:cve,2005-1921; classtype:attempted-admin; sid:13818; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS xmlrpc.php command injection attempt"; flow:to_server,established; content:"POST"; http_method; content:"xml version"; http_client_body; content:"<methodCall><methodName>"; distance:0; http_client_body; content:"</methodName><params><param><value><name>"; distance:0; http_client_body; content:"',''|29 29 3B|echo '_begin_|0A|'|3B|echo"; distance:0; http_client_body; metadata:policy security-ips drop, service http; reference:cve,2005-1921; classtype:attempted-admin; sid:13817; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS isComponentInstalled attack attempt"; flow:to_client,established; file_data; content:"isComponentInstalled|28|boom"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,16870; classtype:attempted-user; sid:13912; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Squid oversized reply header handling exploit attempt"; flow:to_client,established; content:"Content-Length|3A| 3|0D 0A|Server|3A| AAAAAA"; fast_pattern:only; http_header; metadata:policy security-ips drop, service http; reference:bugtraq,12412; reference:cve,2005-0241; classtype:bad-unknown; sid:15580; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 4244 (msg:"SPECIFIC-THREATS MSN Messenger IRC bot calling home attempt"; flow:to_server,established; content:"PASS gooback"; metadata:policy balanced-ips drop, policy security-ips drop; reference:url,www.threatexpert.com/report.aspx?md5=19bffa751aafa9e63420203938a0d8a9; classtype:trojan-activity; sid:15939; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS McAfee LHA Type-2 file handling overflow attempt"; flow:to_client,established; file_data; content:"-lh0-"; content:"|02 C9 C5|M|88 00 02|DDDD"; within:11; distance:13; metadata:policy security-ips drop, service http; reference:bugtraq,12832; reference:cve,2005-0644; classtype:attempted-user; sid:15950; rev:8;)
# alert udp any any -> any 5190 (msg:"SPECIFIC-THREATS ICQ SRV_MULTI/SRV_META_USER overflow attempt"; flow:to_server; content:"|05 00|"; depth:2; content:"|12 02|"; within:2; distance:5; byte_test:1,>,1,12,relative; content:"|05 00|"; content:"n|00|"; within:2; distance:5; content:"|05 00|"; content:"|DE 03|"; within:2; distance:5; byte_test:2,>,512,-11,relative,little; metadata:policy security-ips drop; reference:cve,2004-0362; reference:url,www.eeye.com/html/Research/Advisories/AD20040318.html; classtype:misc-attack; sid:15967; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS zlib Denial of Service"; flow:to_client,established; file_data; content:"x|9C 85 C1 B9 11 80|0|10 04|A|EC A9 9A A0 C4|+|1E 91 7F FE D8 EB|p|DD AD FD 93 B9| KA|D6 82|l|05 D9 0B|r|14 A4|'9|93 5C|I|EE 24|O|92 91 E4|M2}yw[|86|"; metadata:policy security-ips drop, service http; reference:bugtraq,11051; reference:cve,2004-0797; classtype:attempted-user; sid:15981; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS Sybase EAServer WebConsole overflow attempt"; flow:to_server,established; content:"/WebConsole/Login.jsp|3B EA EA EA EA EA EA EA EA|"; http_uri; metadata:policy security-ips drop, service http; reference:bugtraq,14287; reference:cve,2005-2297; classtype:attempted-user; sid:15962; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS PHP strip_tags bypass vulnerability exploit attempt"; flow:to_server,established; content:"/strip/getPoc.php?note=%3Cs%00cript%3Ealert%28%27Oops!%27%29%3B%3C%2Fs%00cript%3E"; metadata:policy security-ips drop, service http; reference:bugtraq,10724; reference:cve,2004-0595; classtype:attempted-user; sid:15977; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS McAfee LHA file handling overflow attempt"; flow:to_client,established; file_data; content:"testfile|F8 1B|U|05 00|P|B4 81 94 01 01|AAAA"; metadata:service http; reference:bugtraq,10243; reference:cve,2005-0643; classtype:attempted-user; sid:15949; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Trend Micro Products Antivirus Library overflow attempt"; flow:to_client,established; file_data; content:"NEKP2E|00 00 00|E|00 00 00 DB|+|D0 1D 00 00| |00 00 00|AAAA"; metadata:service http; reference:bugtraq,12643; reference:cve,2005-0533; classtype:attempted-user; sid:15992; rev:4;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"SPECIFIC-THREATS Red Hat Enterprise Linux DNS resolver buffer overflow attempt"; flow:to_client; content:"|D3 A9 85 80 00 01 00|2"; metadata:service dns; reference:bugtraq,6186; reference:cve,2002-0029; classtype:attempted-admin; sid:15963; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS F-Secure Anti-Virus LHA processing buffer overflow attempt"; flow:to_client,established; file_data; content:"!|C3|-lh0-|18 00 00 00 05 00 00 00 FA BB|m0 |01 08|testfile|F8 1B|U|05 00|P|B4 81 94 01 01|UUUU"; metadata:policy security-ips drop, service http; reference:bugtraq,10243; reference:cve,2004-0234; classtype:attempted-user; sid:15966; rev:6;)
# alert tcp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"SPECIFIC-THREATS MailEnable SMTP service SPF lookup buffer overflow attempt"; flow:to_client,established; content:"|00 01|Q|80 04|9|06|v=spf1|0A|AAAAAAAAAA|0A|AAAAAAAAAA"; metadata:policy security-ips drop, service dns; reference:bugtraq,20091; reference:cve,2006-4616; classtype:attempted-admin; sid:16025; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS X.org PCF parsing buffer overflow attempt"; flow:to_client,established; file_data; content:"|01|fcp|08 00 00 00 01 00 00 00 0E 00 00 00 A0 02 00 00|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:bugtraq,27352; reference:cve,2008-0006; classtype:attempted-user; sid:16070; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS PHP memory_limit vulnerability exploit attempt"; flow:to_server,established; content:"---------------------------153501500631101"; http_header; metadata:service http; reference:bugtraq,10725; reference:cve,2004-0594; classtype:attempted-user; sid:16078; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS Kaspersky Online Scanner trojaned Dll download attempt"; flow:to_server,established; content:"kos-main.jar"; nocase; http_uri; content:!"Host|3A| www.kaspersky.com|0D 0A|"; nocase; http_header; metadata:service http; reference:url,intevydis.com/blog/?p=77; classtype:trojan-activity; sid:16141; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS 2imaegshack/lmageshack IM worm get request attempt"; flow:to_server,established; content:"/s/im.php"; nocase; http_uri; flowbits:set,lmageshack.request; flowbits:noalert; metadata:service http; reference:url,anubis.iseclab.org/?action=result&task_id=1d4d78a7507bb63143d45d2a5898fe3bf&format=html; classtype:misc-activity; sid:16556; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS 2imaegshack/lmageshack IM worm inbound communication attempt"; flow:to_client,established; flowbits:isset,lmageshack.request; file_data; content:"lmageshack"; nocase; metadata:service http; reference:url,anubis.iseclab.org/?action=result&task_id=1d4d78a7507bb63143d45d2a5898fe3bf&format=html; classtype:misc-activity; sid:16557; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Symantec multiple products AeXNSConsoleUtilities buffer overflow attempt"; flow:to_client,established; file_data; content:"<object classid='clsid|3A|B44D252D-98FC-4D5C-948C-BE868392A004'"; fast_pattern:only; content:"=String|28|310,|22|A|22 29|"; content:"=unescape"; distance:0; metadata:policy security-ips drop, service http; reference:bugtraq,36698; reference:cve,2009-3031; classtype:attempted-user; sid:16587; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Green Dam URL handling overflow attempt"; flow:to_client,established; file_data; content:"<=2035"; fast_pattern:only; content:"window.location="; content:"'.html'|3B|"; within:30; nocase; content:"classid=|22|"; distance:0; nocase; content:".dll|23|"; within:100; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,osvdb.org/55126; reference:url,secunia.com/advisories/35435; classtype:attempted-user; sid:16598; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS URSoft W32Dasm Import/Export function buffer overflow attempt"; flow:to_client,established; file_data; content:"|D4 30 00 00 00 00 00 00 00 00 00 00 E0 30 00 00 F0 30 00 00 F8 30 00 00 00 31 00 00 00 00 00 00 78 02|"; isdataat:256,relative; content:!"|00|"; within:256; metadata:policy security-ips drop, service http; reference:bugtraq,12352; reference:cve,2005-0308; classtype:attempted-user; sid:16735; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS ProShow Gold PSH file handling overflow attempt"; flow:to_client,established; file_data; content:"ProShow Gold - Built-In Content/Backgrounds/Abstract_02.jpgAAAAAAAAAAAAAAA"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-3214; reference:url,osvdb.org/show/osvdb/57226; classtype:attempted-user; sid:16731; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Xenorate Media Player XPL file handling overflow attempt - 2"; flow:to_client,established; file_data; content:"AAAAAAAA|EB 06 90 90 4B 3F 01 11 90 90 90 90|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,osvdb.org/show/osvdb/57162; classtype:attempted-user; sid:16738; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Symantec multiple products AeXNSConsoleUtilities RunCMD buffer overflow attempt"; flow:to_client,established; file_data; content:"|2E|RunCMD|28|"; fast_pattern:only; content:"catch|28| e |29 20 7B| window|2E|location|20 3D|"; metadata:policy security-ips drop, service http; reference:bugtraq,37092; reference:cve,2009-3033; classtype:attempted-user; sid:16787; rev:7;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS AwingSoft Winds3D Player SceneURL method command execution attempt"; flow:to_client,established; file_data; content:"clsid|3A|17A54E7D-A9D4-11D8-9552-00E04CB09903"; content:"|3C|param name|3D 22|SceneURL|22| value|3D 22|http|3A 2F 2F|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-2386; reference:cve,2009-4850; classtype:attempted-user; sid:16785; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Orbit Downloader long URL buffer overflow attempt"; flow:to_client,established; file_data; content:"classid|3D 27|clsid|3A|3F1D494B-0CEF-4468-96C9-386E2E4DEC90|27|"; content:"String|28 27|http|3A 2F 2F|"; distance:0; content:!"|27|"; within:255; metadata:policy security-ips drop, service http; reference:cve,2008-1602; reference:cve,2009-0187; classtype:attempted-user; sid:16798; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Antivirus ACE file handling buffer overflow attempt"; flow:to_client,established; file_data; content:"|2A 2A 41 43 45 2A 2A|"; depth:7; offset:7; content:"|01 80 1C 00 00 00 BE 02 00 00 C5 5A 08 33 20 00 00 00 80 98 92 84 02 03 0A 00 54 45 07 02|"; distance:0; metadata:policy security-ips drop, service http; reference:cve,2005-2385; reference:cve,2005-2720; classtype:attempted-user; sid:17244; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS GNU gzip LZH decompression make_table overflow attempt"; flow:to_client,established; file_data; content:"|1F A0 AB CD FF FF FF FF FF FF FF FF FF FF FF FF|"; depth:16; metadata:policy security-ips drop, service http; reference:cve,2006-4335; reference:url,secunia.com/advisories/21996/; classtype:attempted-user; sid:17289; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"SPECIFIC-THREATS MS SQL Server INSERT Statement Buffer Overflow attempt"; flow:to_server, established; content:"i|00|n|00|s|00|e|00|r|00|t|00 20 00|i|00|n|00|t|00|o|00 20 00|m|00|y|00|t|00|a|00|b|00|l|00|e|00 20 00|v|00|a|00|l|00|u|00|e|00|s|00 20 00 28 00|n|00|u|00|l|00|l|00 29|"; reference:cve,2008-0106; classtype:policy-violation; sid:17307; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SPECIFIC-THREATS McAfee VirusScan on-access scanner long unicode filename handling buffer overflow attempt"; flow:to_client,established; content:"|52 61 72 21 1A 07 00 CF 90 73 00 00 0D|"; content:"|E2 CA D4 B2 E2 CA D4 B2|"; distance:0; metadata:policy security-ips drop; reference:bugtraq,23543; reference:url,knowledge.mcafee.com/SupportSite/dynamickc.do?externalId=612750&command=show&forward=nonthreadedKC; classtype:attempted-dos; sid:17297; rev:4;)
alert udp $EXTERNAL_NET any -> $DNS_SERVERS 53 (msg:"SPECIFIC-THREATS ISC BIND RRSIG query denial of service attempt"; content:"|03 77 77 77 04 74 65 73 74 03 63 6F 6D 00 00 2E 00 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service dns; reference:bugtraq,23738; reference:cve,2007-2241; classtype:attempted-dos; sid:17299; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS ClamAV libclamav PE file handling integer overflow attempt"; flow:to_client,established; file_data; content:"|4D 5A 90 00 03 00 00 00 04 00 00 00 FF FF 00 00 B8 00 00 00 00 00 00 00 40 00|"; isdataat:288,relative; content:"|00 00 2E 70 65 74 69 74 65 00 00 D0 0D 00 00 30 FF FF A3 D1|"; within:20; distance:288; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0318; classtype:attempted-user; sid:17305; rev:3;)
# alert tcp $EXTERNAL_NET 110 -> $HOME_NET any (msg:"SPECIFIC-THREATS IBM Lotus Notes Cross Site Scripting attempt"; flow:to_client,established; content:"<SCRIPT>|0D 0A|alert|28 22|"; nocase; metadata:policy security-ips drop, service pop3; reference:bugtraq,14164; reference:cve,2005-2175; classtype:string-detect; sid:17346; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SPECIFIC-THREATS Lighttpd mod_fastcgi Extension CGI Variable Overwriting Vulnerability attempt"; flow:to_server,established; content:"SCRIPT_FILENAME/etc/passwd|06 80 00|"; nocase; metadata:policy security-ips drop, service http; reference:bugtraq,25622; reference:cve,2007-4727; classtype:attempted-user; sid:17386; rev:5;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"SPECIFIC-THREATS Squid proxy DNS response spoofing attempt"; content:"|C0 10 00 02 00 01 00 01 51 80 00 05 02 6E 73 C0 10|"; detection_filter:track by_src, count 1000, seconds 1; metadata:policy security-ips drop, service dns; reference:bugtraq,13592; reference:cve,2005-1519; classtype:attempted-dos; sid:17495; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SPECIFIC-THREATS Adobe RoboHelp Server Arbitrary File Upload and Execute"; flow:to_server,established; content:"/robohelp/robo/reserved/web/"; nocase; http_uri; content:".jsp"; nocase; http_uri; pcre:"/\x2frobohelp\x2frobo\x2freserved\x2fweb\x2f[^\r\n]{0,60}\x2Ejsp/Ui"; metadata:service http; reference:bugtraq,35282; reference:cve,2009-1855; classtype:attempted-user; sid:17529; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS nginx URI parsing buffer overflow attempt"; flow:to_server,established; content:"GET |2F 25|23|2E 2E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,36384; reference:cve,2009-2629; classtype:attempted-admin; sid:17528; rev:4;)
# alert tcp $EXTERNAL_NET 41523 -> $HOME_NET any (msg:"SPECIFIC-THREATS Products Discovery Service Buffer Overflow"; flow:to_client,established; flowbits:isnotset,CA.response; flowbits:set,CA.response; content:"TESTTESTTESTTESTTESTTESTTEST"; fast_pattern:only; isdataat:990; metadata:policy security-ips drop; reference:bugtraq,20364; reference:cve,2006-5143; classtype:attempted-user; sid:17620; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Java Web Start arbitrary command execution attempt"; flow:to_client,established; file_data; content:"8AD9C840-044E-11D1-B3E9-00805F499D93"; nocase; content:"jnlpDocbase=|22|ABBA|3A|"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39346; reference:cve,2010-0886; reference:cve,2010-1423; classtype:attempted-user; sid:17660; rev:2;)
# alert tcp $EXTERNAL_NET 41523 -> $HOME_NET any (msg:"SPECIFIC-THREATS Products Discovery Service Buffer Overflow"; flow:to_client,established; flowbits:isnotset,CA.response; flowbits:set,CA.response; content:"|9B 17 F6 4A 1D 01 E7 52 11 C3 61 7B 9B B0 62 52|"; fast_pattern:only; isdataat:990; metadata:policy security-ips drop; reference:bugtraq,20364; reference:cve,2006-5143; classtype:attempted-user; sid:17621; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Sun Microsystems Java gif handling memory corruption attempt"; flow:to_client,established; file_data; content:"|52 4B 55 F6 EF DF 63 70 A3 6C 5C 5B 48 71 BB 7A 70 77 3B 44 69 5B|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:bugtraq,22085; reference:cve,2007-0243; classtype:attempted-user; sid:17628; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Java AWT ConvolveOp memory corruption attempt"; flow:to_client,established; file_data; content:"java/awt/image/ConvolveOp|0C 00 0E 00 23 01 00|"; fast_pattern:only; metadata:policy security-ips drop, service http; reference:bugtraq,21675; reference:url,sunsolve.sun.com/search/document.do?assetkey=1-26-102729-1; classtype:attempted-user; sid:17604; rev:7;)
# alert udp $EXTERNAL_NET any -> $DNS_SERVERS 53 (msg:"SPECIFIC-THREATS ISC BIND DNSSEC Validation Multiple RRsets DoS"; flow:to_server; content:"|01 10|"; depth:2; offset:2; content:"|00 80 01 00 01 00 00 29|"; isdataat:!9,relative; content:"|03|com"; content:"|03|com"; within:4; distance:4; metadata:policy security-ips drop, service dns; reference:bugtraq,22231; reference:cve,2007-0494; classtype:attempted-dos; sid:17680; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS BitDefender Internet Security script code execution attempt"; flow:to_client,established; file_data; content:"PK|03 04 0A|"; content:"|3C 68 31 3E 20 69 64 3D 22 68 65 61 64 65 72 22 20 6F 6E 6D 6F 75 73 65 6D 6F 76 65 3D 22 61 6C 65 72 74 28 27 41 73 73 75 72 65 6E 74 20 53 65 63 75 72 65 20 54|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0850; classtype:attempted-user; sid:17778; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Thinkpoint fake antivirus binary download"; flow:to_client,established; file_data; content:"|30 B6 AD D9 C7 B7 41 8E 75 6E 65 78 70 30 65 B4 26 6D|"; content:"|BA 3A 0D 0A 4F E8 7A 65 7E 66 B5 05 EF AD 61 49 C9 80 75 6D 58|"; within:100; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2010-090610-2408-99; classtype:trojan-activity; sid:17817; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Multiple browser marquee tag denial of service attempt"; flow:to_client,established; file_data; content:"document.write|28 27|<html><marquee><h1>|27|+buffer+buffer|29 3B|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,18165; reference:cve,2006-2723; classtype:attempted-dos; sid:18188; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS Secure Backup login.php uname variable based command injection attempt"; flow:to_server,established; content:"login.php"; http_uri; content:"attempt="; http_uri; content:"uname=%"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-5449; classtype:attempted-admin; sid:18293; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS Multiple vendor anti-virus extended ASCII filename scan bypass attempt"; flow:to_server,established; content:"ascii|2F|eicar|01|1.com"; http_uri; metadata:service http; reference:url,osvdb.org/show/osvdb/19749; classtype:misc-attack; sid:18524; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS OpenSSL CMS structure OriginatorInfo memory corruption attempt"; flow:to_client,established; file_data; content:"|06 09 2A 86 48 86 F7 0D 01 07 03|"; content:"|A0 03 02 01 02 02 0B 01 00 00 00 00 01 16 0F 8C 27 81|"; within:48; metadata:service http; reference:bugtraq,40502; reference:cve,2010-0742; classtype:attempted-user; sid:18766; rev:4;)
# alert tcp $EXTERNAL_NET [443,8888] -> $HOME_NET any (msg:"SPECIFIC-THREATS OpenSSL ssl3_get_key_exchange use-after-free attempt"; flow:to_client,established; ssl_state:server_keyx; content:"|03 00 17 41 04 DE 85 30 79 B2 47 60 F1 BB 59 B6 03 F3 1F 6F 05|"; fast_pattern:only; metadata:service ssl; reference:bugtraq,42306; reference:cve,2010-2939; classtype:attempted-admin; sid:19092; rev:5;)
# alert tcp $EXTERNAL_NET [443,8888] -> $HOME_NET any (msg:"SPECIFIC-THREATS OpenSSL ssl3_get_key_exchange use-after-free attempt"; flow:to_client,established; ssl_state:server_keyx; content:"|03 00 17 41 04 04 65 28 13 29 CF 08 AA AC 13 CE 6C 72 AB D2 E5|"; fast_pattern:only; metadata:service ssl; reference:bugtraq,42306; reference:cve,2010-2939; classtype:attempted-admin; sid:19091; rev:5;)
# alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"SPECIFIC-THREATS strongSwan Certificate and Identification payload overflow attempt"; flow:to_server; content:"|00 00 00 14 E3 53 34 B2 09 54 7F 6A A4 D9 F4 A9 A3 88 DE DD|"; fast_pattern:only; metadata:policy security-ips drop; reference:bugtraq,42444; reference:cve,2010-2628; classtype:attempted-admin; sid:19182; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS sidename.js script injection"; flow:to_server,established; content:"/sidename.js"; nocase; http_uri; flowbits:set,http.multimesh; metadata:service http; reference:url,blog.armorize.com/2011/06/mass-meshing-injection-sidenamejs.html; classtype:attempted-user; sid:19297; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS probable multi-mesh injection attack"; flow:to_client,established; flowbits:isset,http.multimesh; file_data; content:"document.createElement|28|"; depth:50; metadata:service http; reference:url,blog.armorize.com/2011/06/mass-meshing-injection-sidenamejs.html; classtype:attempted-user; sid:19300; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS cssminibar.js script injection"; flow:to_server,established; content:"/cssminibar.js"; nocase; http_uri; flowbits:set,http.multimesh; metadata:service http; reference:url,blog.armorize.com/2011/06/mass-meshing-injection-sidenamejs.html; classtype:attempted-user; sid:19298; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS banner.txt access - possible compromised multi-mesh injection server"; flow:to_server,established; content:"/banner.txt"; nocase; http_uri; flowbits:set,http.multimesh; flowbits:noalert; metadata:service http; reference:url,blog.armorize.com/2011/06/mass-meshing-injection-sidenamejs.html; classtype:misc-activity; sid:19299; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS sl.php script injection"; flow:to_client,established; file_data; content:"script src=http|3A 2F 2F|"; nocase; content:"|2F|sl.php"; within:50; fast_pattern; nocase; metadata:service http; reference:url,isc.sans.edu/diary.html?storyid=12127; classtype:misc-activity; sid:20660; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SPECIFIC-THREATS 427BB cookie-based authentication bypass attempt"; flow:to_server,established; content:"Host|3A|"; nocase; http_header; content:"nNmHPwTkaDxWXETFmPuHxnu"; within:30; fast_pattern; nocase; http_header; content:"username|3D|admin"; nocase; http_cookie; content:"authenticated|3D|1"; nocase; http_cookie; content:"usertype|3D|admin"; nocase; http_cookie; metadata:service http; reference:cve,2006-0153; classtype:attempted-admin; sid:20737; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Ultra Shareware Office HttpUpload buffer overflow attempt"; flow:to_client,established; file_data; content:".HttpUpload"; fast_pattern; nocase; isdataat:10,relative; content:!"|29|"; within:10; metadata:policy security-ips drop, service http; reference:bugtraq,30861; reference:cve,2008-3878; classtype:attempted-user; sid:21759; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SPECIFIC-THREATS Xenorate Media Player XPL file handling overflow attempt - 1"; flow:to_client,established; file_data; isdataat:92; content:!"|00|"; depth:92; content:"|FD A4 00 10|"; depth:4; offset:92; metadata:service http; reference:url,osvdb.org/show/osvdb/57162; classtype:attempted-user; sid:16737; rev:5;)
