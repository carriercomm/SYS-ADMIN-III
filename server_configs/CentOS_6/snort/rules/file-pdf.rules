alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader/Acrobat Pro CFF font parsing heap overflow attempt"; flow:to_client,established; file_data; content:"6SC.Pseudo.Font.1|00 00 01 01 87|T|01 01 FF|T|00|V|02 00 01|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1241; classtype:attempted-user; sid:16546; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Possible Adobe Reader ActionScript byte_array heap spray attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"ByteArray"; nocase; content:"|04 0C 0C 0C 0C|"; within:100; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,35759; reference:cve,2009-1862; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:attempted-user; sid:15728; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader CoolType.dll remote memory corruption denial of service attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 9C C5 97 4D 4B C4 30 10 86 EF 85 FE 87 39 26 87 CD 26 33|"; fast_pattern:only; content:"|AC 6D EE D5 DD 46 CF 88 D4 87 76 9D 7A D7 B3 A0 40 63 A7 6E F4 2C AA 27 8D A4 5E 35 59 B5 9B E3|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,41130; reference:cve,2010-2204; classtype:attempted-dos; sid:16801; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe JPEG2k uninitialized QCC memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|12 12 E0 0F 12 12 E0 0F 12 12 FF|]|00 16|LL"; content:"setTimeout|28 22|doSpray|28 29 22|,2500|29 3B|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2995; classtype:attempted-user; sid:16323; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader U3D progressive mesh continuation pointer overwrite attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<|FF FF FF C5 00 00 00 00 00 00 00 05 00|Box01|00 00 00 00 00 00 00 00 18 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01|k|01 00 00|k|01 00 00 D5 02 00 00 BF 85|]K|00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2998; classtype:attempted-user; sid:16173; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader U3D line set heap corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"7|FF FF FF|h|00 00 00 00 00 00 00 06 00|Box_92|00 00 00 00 00 00 00 00 04 05 00 00| |00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|AAAA"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2997; classtype:attempted-user; sid:16172; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe collab.addStateModel remote corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"Collab.addStateModel"; nocase; content:"cname"; nocase; content:"00"; within:15; distance:2; nocase; pcre:"/Collab\x2EaddStateModel\s*\x28\s*\x7B.*cName\s*\x3A\s*\x22(\x22|\x5Cx00)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2996; classtype:attempted-user; sid:16176; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe collab.removeStateModel denial of service attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|5C|x00|5C|x00|5C|x00|5C|x00"; nocase; content:"Collab.removeStateModel"; nocase; pcre:"/var\s*(\w+)\s*\x3D\s*\x22\x5Cx00\x5Cx00\x5Cx00\x5Cx00.*\x22.*Collab\x2EremoveStateModel\s*\x28\s*\1.*\x29/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2988; classtype:attempted-user; sid:16175; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader U3D progressive mesh continuation off by one index attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<|FF FF FF C5 00 00 00 00 00 00 00 05 00|Box01|00 00 00 00 00 00 00 00 08 00 00 00|ABCD"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-3458; classtype:attempted-user; sid:16174; rev:6;)
# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2012 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2012 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#----------------
# FILE-PDF RULES
#----------------

# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF pdf file sent via email"; flow:to_server,established; content:"JVBERi0x"; flowbits:set,email.pdf; flowbits:noalert; metadata:service smtp; classtype:policy-violation; sid:15361; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF attempted download of a PDF with embedded Flash"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"stream"; nocase; pcre:"/stream[\x0A\x0D]{1,2}[CF]WS/i"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:15727; rev:20;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader start-of-file alternate header obfuscation"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"%!PS-Adobe-"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf; classtype:misc-activity; sid:16354; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader alternate file magic obfuscation"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"%COS-0.2"; depth:1032; content:"PDF-"; distance:0; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf; classtype:misc-activity; sid:16390; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF PDF with click-to-launch executable"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/La"; within:100; nocase; content:"/F"; pcre:"/\/La(.)*?\s*?\/F[^\/>]+\.(exe|dll|com|swf)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:16523; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF download of a PDF with embedded JavaScript - JS string attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/JS"; distance:0; fast_pattern; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*?\x2fJS[\s<>]/smi"; metadata:service http, service imap, service pop3; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:17668; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF PDF file with embedded PDF object"; flow:established,to_client; file_data; content:"EmbeddedFile"; nocase; content:"3C7064663E"; distance:0; nocase; content:"3C2F7064663E"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:18684; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF transfer of a PDF with embedded JavaScript - JavaScript string attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/JavaScript"; distance:0; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*\x2fJavaScript/smi"; metadata:service http, service imap, service pop3; reference:cve,2013-0622; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:18681; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF transfer of a PDF with OpenAction object attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/OpenAction"; distance:0; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*\x2fOpenAction/smi"; metadata:service http, service imap, service pop3; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:18682; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF attempted download of a PDF with embedded Flash"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"stream"; nocase; pcre:"/stream[\x0A\x0D]{1,2}[CF]WS/i"; metadata:service smtp; reference:bugtraq,35758; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19269; rev:7;)
# alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"FILE-PDF attempted download of a PDF with embedded Flash"; flow:to_client,established; content:"stream"; nocase; pcre:"/stream[\x0A\x0D]{1,2}[CF]WS/i"; metadata:service netbios-ssn; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19268; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF PDF with click-to-launch executable"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"/F"; content:"/Mac"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fMac\s*\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:19648; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF PDF with click-to-launch executable"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"/F"; content:"/Unix"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fUnix\s*\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:19647; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF PDF with click-to-launch executable"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"/F"; content:"/DOS"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fDOS\s*\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:19646; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF attempted download of a PDF with embedded PICT image"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"PICT"; fast_pattern:only; content:"stream"; nocase; pcre:"/^[^\x0A]*?.{88}PICT/mR"; metadata:policy security-ips drop, service http, service imap, service pop3; classtype:policy-violation; sid:20146; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF attempted download of a PDF with embedded PCX image"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"stream"; nocase; pcre:"/^[^\x0A]*?\x0A[\x00\x02\x03\x05][\x00\x01][\x01\x04\x08\x24].{60}\x00.{5}\x00{58}/mR"; metadata:policy security-ips drop, service http, service imap, service pop3; classtype:policy-violation; sid:20151; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader util.printf buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"util.printf"; pcre:"/\x28\s*\x22\s*\x25([2-9][6-9][5-9]|[1-9][0-9]{3,})f/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2008-2992; classtype:attempted-user; sid:15014; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader FlateDecode integer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/DecodeParms"; content:"/Predictor"; distance:0; byte_test:4,>,1,1,relative,string,dec; pcre:"/\x2fDecodeParms\s*\x3c{2}\s*(?=[^\x3e]*\/Predictor\s+0*(1\d{1}|[2-9]))([^\x3e]*\x2fBitsPerComponent\s+\d{3}|[^\x3e]*\x2fColumns\s+\d{5}|[^\x3e]*\x2fColors\s+\d{5})/"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,35294; reference:bugtraq,36600; reference:cve,2009-1856; reference:cve,2009-3459; classtype:attempted-user; sid:15709; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader javascript getIcon method buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"Collab.getIcon"; fast_pattern:only; pcre:!"/Collab\.getIcon[^\x28]*?\x28\s*([\x22\x27])[^\1]{1,256}\1\s*\x29/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,34169; reference:cve,2009-0927; classtype:attempted-user; sid:16554; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader spell.customDictionaryOpen exploit attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"spell.customDictionaryOpen|5C|(0,dict|5C|)"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,34740; reference:cve,2009-1493; classtype:attempted-user; sid:15492; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader getAnnots exploit attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"getAnnots"; nocase; pcre:"/getAnnots\x5C?\([^\x29\x2C]+\x2C\s*[^\x29\x2C]+\x2C\s*[^\x29\x2C]+\x2C\s*-\d/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,34736; reference:cve,2009-1492; classtype:attempted-user; sid:15493; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader Linux malformed U3D mesh deceleration block exploit attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"stream|0A|U3D"; fast_pattern:only; pcre:"/stream\nU3D[^<]*\x31\xff\xff\xff/si"; byte_jump:2, 8, relative, little; byte_test:4, >, 97612893, 32, relative, little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-0196; classtype:attempted-user; sid:16603; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader icc mluc interger overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"mluc|00 00 00 00|"; byte_test:4,>,357913941,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43729; reference:cve,2010-3622; classtype:attempted-user; sid:18308; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader JpxDecode invalid crgn memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"jp2c|FF 4F|"; content:"|FF 5E 00|"; distance:0; pcre:"/\xff\x5e\x00(\x05[\x80-\xff]|\x06\x00[\x80-\xff]|\x06[^\x00])/"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,37757; reference:cve,2009-3955; classtype:attempted-user; sid:18801; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader invalid PDF JavaScript extension call"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"printSeps"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-4091; reference:url,www.adobe.com/support/security/bulletins/apsb10-28.html; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-admin; sid:18102; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader doc.export arbitrary file write attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:".export"; nocase; pcre:"/\x2eexport(AsFDF|AsText|AsXFDF|DataObject|XFAData)\x28[^\x2c\x29]*\x2c[^\x2c\x29]*\x2c[^\x29]+\x2eexe/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2993; classtype:attempted-user; sid:16324; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader embedded BMP colors used integer overflow attempt"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"stream"; nocase; content:"BM"; within:20; content:"|00 00 00 00|"; within:4; distance:4; content:"|28 00 00 00|"; within:4; distance:4; byte_test:4,>,0x1FFFFFFF,28,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-4373; reference:url,www.adobe.com/support/security/bulletins/apsb12-01.html; classtype:attempted-user; sid:20921; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader embedded BMP bit count integer overflow attempt"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"stream"; nocase; content:"BM"; within:20; content:"|00 00 00 00|"; within:4; distance:4; content:"|28 00 00 00|"; within:4; distance:4; pcre:"/^.{10}([^\x01\x04\x08\x0F\x10\x18\x20].|.[^\x00]).{16}\x00\x00\x00\x00/R"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-4373; reference:url,www.adobe.com/support/security/bulletins/apsb12-01.html; classtype:attempted-user; sid:20922; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader embedded BMP bit count integer overflow attempt"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"stream"; nocase; content:"BM"; within:20; content:"|00 00 00 00|"; within:4; distance:4; content:"|0C 00 00 00|"; within:4; distance:4; pcre:"/^.{6}([^\x01\x04\x08\x0F\x10\x18\x20].|.[^\x00])/R"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-4373; reference:url,www.adobe.com/support/security/bulletins/apsb12-01.html; classtype:attempted-user; sid:20923; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader libtiff TIFFFetchShortPair stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"stream|0A 78 9C ED 5B 49 73 E2 38 14 BE F7 AF 70 79 6E C3 34 62 87 A4 42 BA C4 36 90 C4 01 C2 9A 5C BA 84 2D 1B 07 DB 32 96 1C 03 BF 7E 24 2F 6C D3 3D 9D C3 54 4D 4D 95 5C F5 81 DE|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2006-3459; reference:cve,2010-0188; classtype:attempted-user; sid:17215; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader libtiff TIFFFetchShortPair stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"stream|0A 78 9C ED 5B 5B 6F E2 38 14 7E EF AF 88 B2 6F CB 0E E6 0E AD 0A 23 73 5B 68 9B 02 E5 DA BE 8C 4C E2 04 97 24 0E B1 D3 00 BF 7E ED 24 B4 94 99 DD 19 69 1F 56 5A 39 D2 07 E7 F6 1D 1F DB 71 9E 7C|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2006-3459; reference:cve,2010-0188; classtype:attempted-user; sid:17214; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader PDF subroutine pointer attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|90 90 90 E8 00 00 00 00 5B 90 66 C7 03 EB FE|"; fast_pattern:only; content:"RICN"; content:"AR07"; within:6; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2006-5857; classtype:attempted-user; sid:21765; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat Plugin Universal cross-site scripting attempt"; flow:to_client,established; file_data; content:".pdf|23|"; fast_pattern:only; pcre:"/\x2Epdf\x23[^\r\n]+\x3Djavascript\x3A/smi"; metadata:service http, service imap, service pop3; reference:cve,2007-0045; reference:url,isc.sans.org/diary.php?storyid=1999; classtype:misc-attack; sid:9842; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat Plugin JavaScript parameter double free attempt"; flow:to_client,established; file_data; content:".pdf|23|"; fast_pattern:only; content:"document."; nocase; pcre:"/\x2Epdf\x23[^\r\n]+\x3Djavascript\x3A[^\r\n]*document\x2E\w+/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2007-0046; reference:url,www.adobe.com/support/security/advisories/apsa07-01.html; classtype:attempted-user; sid:9843; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader JPX malformed code-block width attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|6A 50 20 20|"; content:"|FF 4F FF 51|"; distance:0; byte_jump:2,36,relative,multiplier 3,big; content:"|FF 52 00 0C|"; within:4; byte_test:1,>,16,5,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,35274; reference:bugtraq,35289; reference:cve,2009-1859; reference:url,www.adobe.com/support/security/bulletins/apsb09-07.html; classtype:attempted-user; sid:15562; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat PDF font processing memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"obj<<"; content:"/BaseFont"; distance:0; content:"endobj"; distance:0; pcre:"/obj\x3c\x3c.*?\x2fBaseFont\x2f[^\x80-\xff\x2f]*[\x80-\xff].*?endobj/s"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,32100; reference:cve,2008-4813; reference:url,vallejo.cc/proyectos/adobereader812.html; classtype:attempted-user; sid:15867; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader media.newPlayer memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/S/JavaScript"; content:"this.media.newPlayer"; pcre:"/^\x5C?\x28null\x5C?\x29/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,37331; reference:cve,2009-4324; classtype:attempted-user; sid:16333; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Xpdf Splash DrawImage integer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Subtype"; content:"/Image"; within:20; content:"/FlateDecode"; pcre:"/\x3C{2}(?=[^\x3E]*\x2F(Height|Width)\s*\d{6})(?=[^\x3E]*\x2FFlateDecode)[^\x3E]*\x2FSubtype\s*\x2FImage/"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,36703; reference:cve,2009-3604; classtype:attempted-user; sid:16355; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader malformed FlateDecode colors declaration"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"FlateDecode"; content:"DecodeParms"; pcre:"/DecodeParms\s*\[[^\]]*Colors\s*\d\d\d\d/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,36600; reference:cve,2009-3459; classtype:attempted-user; sid:16677; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader shell metacharacter code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"begin|20|"; depth:6; pcre:"/^begin\s\d+\s[^\s\r\n\t]*\x60/sm"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,10931; reference:cve,2004-0630; classtype:attempted-user; sid:18527; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Subtype"; nocase; content:"/TrueType"; within:20; nocase; content:"name"; within:1024; byte_test:4,=,0,8,relative; content:"SING"; byte_test:4,!=,0,8,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18987; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Subtype"; nocase; content:"/OpenType"; within:20; nocase; content:"name"; within:1024; byte_test:4,=,0,8,relative; content:"SING"; byte_test:4,!=,0,8,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18986; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader malicious language.engtesselate.ln file download attempt"; flow:to_client,established; flowbits:isset,file.engtesselate; file_data; content:"2="; isdataat:255,relative; content:!"|0A|"; within:255; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2095; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19253; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader CIDFont dictionary glyph width corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|2F|Subtype|20 2F|CIDFontType2"; content:"|2F|W|20 5B|0|20 5B|778|20|0|5D 20|2|20|3|20|250|20|4|20 5B|333|20|408|5D|"; distance:0; content:"|5B|556|20|722|20|667|20|556|20|611|5D|"; distance:0; metadata:service http, service imap, service pop3; reference:cve,2011-2105; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19251; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader javascript in PDF go-to actions exploit attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/S /GoToR"; content:"/F |28|javascript:"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2101; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19254; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|28 69 90 CC 10 42 88 0A D9 21 25 52 F6 DE 23 23|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19417; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Apple iOS 4.3.3 jailbreak for iPad download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 5C 8E FB E3 3F FE 86 8C 86 A2 A1 41 32 22 69 A7 52 69 A2 D2 56 89 64 A5 BD 35 35|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19416; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Apple iOS 4.3.3 jailbreak for iPod download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 3C 97 FB FF 3F 7E 23 0D 23 CA C8 28 69 90 64 13 21 44 85 B2 0A 91 68 C8 DE 5B 46|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19419; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Apple iOS 4.3.3 jailbreak for iPhone download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|78 DA ED DD 07 3C D7 7B FF 3F 7E 2A 29 15 1A 94 64 A5 32 B2 25 45 94 0A 89 22 85 64 25 7B CB DE|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,jailbreakzone.com/2011/07/02/jailbreakme-3-0-leaked-try-it-out-now/; classtype:attempted-admin; sid:19418; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader sandbox disable attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|B6 84 05 8D 81 80 08 FF E3 A1 87 05 EA 88 A8 83 05 DE 8B B6 04 EA 80 80 08 D6 8B B6 04 99 D0 81 D0 06 EA 80 08 EA 80 A8 03 81 8A B6 04 D0 80 80|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-1353; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20162; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat embedded IFF file RGBA chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"Subtype|2F|image"; nocase; content:"iff"; within:7; content:"TBHD"; distance:0; byte_extract:4,0,tbhd_width,relative; content:"RGBA"; distance:0; byte_test:2,>,tbhd_width,2,relative; metadata:service http, service imap, service pop3; reference:cve,2011-2436; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20149; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat embedded TIFF DotRange structure memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"Subtype|2F|image"; nocase; content:"tiff"; within:7; content:"II|2A 00|"; within:250; content:"|50 01|"; distance:0; byte_test:2,<,14,0,relative,little; byte_test:2,>,8,2,relative,little; metadata:service http, service imap, service pop3; reference:cve,2011-2432; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20144; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat getCosObj file overwrite attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:".write|28|"; nocase; content:".getCosObj|28|"; distance:0; nocase; pcre:"/([A-Z\d_]+)\.write\x28.*?\1\.getCosObj\x28/smi"; metadata:service http, service imap, service pop3; reference:cve,2011-2442; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20156; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe field flags exploit attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Ff "; byte_test:10,!&,0x80000000,0,string,relative; byte_test:10,&,0x00100000,0,string,relative; metadata:service http, service imap, service pop3; reference:cve,2011-0589; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18419; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader CCITT stream compression filter invalid image size heap overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|2F|CCITTFaxDecode"; nocase; content:"|2F|Columns"; within:500; nocase; byte_test:10,>,65535,0,relative,string; pcre:"/\x2FCCITTFaxDecode[^\x3E]*\x2fColumns\s+\d{5}/i"; metadata:service http, service imap, service pop3; reference:cve,2011-0567; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18507; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader CCITT stream compression filter invalid image size heap overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|2F|CCF"; nocase; content:"|2F|Columns"; within:500; nocase; byte_test:10,>,65535,0,relative,string; pcre:"/\x2FCCF[^\x3E]*\x2fColumns\s+\d{5}/i"; metadata:service http, service imap, service pop3; reference:cve,2011-0567; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18506; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat XML entity escape attempt"; flow:to_client,established; file_data; content:"<|21|ENTITY"; nocase; content:"SYSTEM"; within:50; nocase; content:"http|3A 2F 2F|"; within:50; nocase; content:"http|3A 2F 2F|"; within:500; nocase; pcre:"/<\x21ENTITY[^>]+SYSTEM[^>]+http\x3A\x2F\x2F[^>\s]+http\x3A\x2F\x2F/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0604; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18456; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader File containing Flash use-after-free attack attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|3C 3C 2F 46 69 6C 74 65 72 2F 46 6C 61 74 65 44 65 63 6F 64 65 2F 46 69 72 73 74 20 39 39 2F 4C 65 6E 67 74 68 20 35 31 31 2F 4E 20 31 35 2F 54 79 70 65 2F 4F 62 6A 53 74 6D 3E 3E 73 74 72 65 61 6D 0D 0A 68 DE 6C 52 DB 6E E2 30|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1297; classtype:attempted-user; sid:16633; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader malformed Richmedia annotation exploit attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Subtype/RichMedia"; fast_pattern:only; content:"/Annot"; pcre:"/\/Rect\s*\[[^\]]*\./"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-0197; reference:cve,2010-1297; classtype:attempted-admin; sid:16545; rev:14;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader oversized object width attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/width"; nocase; byte_test:7,>,1000000,1,relative,string; content:"/DCTDecode"; distance:0; nocase; pcre:"/\x2fwidth[^\x3e]+\x2fDCTDecode/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2980; classtype:attempted-user; sid:16322; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader U3D CLODMeshContinuation code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"U3D|00|"; content:"1|FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,<,16777216,12,relative,little; content:"<|FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,>,16777215,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,36665; reference:cve,2009-2990; reference:url,www.adobe.com/support/security/bulletins/apsb09-15.html; classtype:attempted-user; sid:16373; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Foxit Reader title overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Title"; nocase; pcre:"/^\s*(\x28[^\x29]{538}|\x3c[^\x3e]{538})/Rs"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43785; classtype:attempted-user; sid:20445; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader U3D CLODMeshDeceleration code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"U3D|00|"; content:"|31 FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,>,200,12,relative,little; content:"|3C FF FF FF|"; distance:0; byte_jump:2,8,relative,little; byte_test:4,<,200,12,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-3953; classtype:attempted-user; sid:20429; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed shading modifier heap corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:" obj |0A|<<|0A|"; content:"/Subtype /U3D|0A|"; within:50; fast_pattern; content:"Length"; distance:0; byte_extract:4,1,length,relative,string,dec; content:"/Type /3D|0A|>>|0A|stream|0A|"; within:20; distance:1; content:"|45 FF FF FF|"; within:length; byte_jump:2,8,relative,little; byte_test:4,>,0,8,relative; byte_test:4,=,0,12,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2462; reference:url,osvdb.org/77529; reference:url,www.adobe.com/support/security/advisories/apsa11-04.html; classtype:attempted-user; sid:20659; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader javascript submitform memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"submitForm"; fast_pattern:only; pcre:"/submitForm\s*\x28[^\x3b]+cURL\s*\x3a\s*[\x22\x27]\s*url\s*\x3a\s*(?!https?)[^\x27\x22\x23]*?\x23/ims"; isdataat:50; content:!"bGet"; within:50; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-4371; reference:url,www.adobe.com/support/security/bulletins/apsb12-01.html; classtype:attempted-user; sid:20998; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Foxit Reader malicious pdf file write access"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"createDataObject"; fast_pattern:only; pcre:"/createDataObject\(\s*?[\x22\x27][cdef]\x3A[\x2F\x5C]/i"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,scarybeastsecurity.blogspot.com/2011/03/dangerous-file-write-bug-in-foxit-pdf.html; classtype:attempted-user; sid:21095; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat file extension overflow attempt"; flow:to_client,established; content:"Content|2D|Type|3A|"; nocase; http_header; content:"application|2F|pdf"; within:30; fast_pattern; nocase; http_header; pcre:"/filename\x3d[^\r\n]*(\x2e[^\x22\x27\r\n]{18,}[\x22\x27])/Hsmi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,10696; reference:cve,2004-0632; classtype:attempted-user; sid:21162; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Foxit Reader createDataObject file write attempt"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"createDataObject"; nocase; pcre:"/^\s*\x5C?\x28\s*[\x22\x27][a-z]\x3A[\x2F\x5C]/iR"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,scarybeastsecurity.blogspot.com/2011/03/dangerous-file-write-bug-in-foxit-pdf.html; reference:url,www.osvdb.org/71104; classtype:attempted-user; sid:21254; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader compressed media.newPlayer memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"&|EA A7 7C 9A 1D C4 1C FE|&|7F|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-4324; classtype:attempted-user; sid:16334; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed TIFF remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|EB|/|ED|Z|B9|qX|F4 D8|C|F5|a|BF|+|0D 8C D2 F3 DD|*|EE 09|W|B1 B3 9B|P|EB AD D1 B3 07 A0|4|D8|m|7C 7F EB B5 EF|j|E8 F5|m[+t|8F 7C BC|f|BB 86|ql|F7 C0 C3 E8|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-0188; reference:url,www.adobe.com/support/security/bulletins/apsb10-07.html; classtype:attempted-user; sid:16490; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat font parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|01|pmaxp|02 ED 0A 7B 00 00|p|0E 00 00 00 20|name|EA 2E F3 EE 00 00|p.|00 00 04|aposts|F1|o|84 00 00|t|8F 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,44203; reference:cve,2010-2862; classtype:attempted-user; sid:17288; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF BitDefender Antivirus PDF processing memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|25 50 44 46 2D 31 2E 33 0A 25 E2 E3 CF D3 0A 33|"; depth:16; content:"|3C 3C 2F 46 69 6C 74 65 72 20 5B 2F 46 6C 61 74 65 44 65 63 6F 64 65 20 2F 41 53 43 49 49 48 65 78 44 65 63 6F 64 65 5D|"; within:40; distance:8; content:"|78 9C ED C2 31 0D 00 00 00 02 A0 4C 6E F6 CF 66 0D 0F 06 4D 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 38 30 4B 03 6A 32|"; within:45; distance:22; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,32396; reference:cve,2008-5409; classtype:attempted-user; sid:17430; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader PDF Catalog Handling denial of service attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"3 0 obj|0D 3C 3C 20 0D|/Type /Pages|20 0D|"; fast_pattern; nocase; content:"/Kids|20 5B 20|3 0 R |5D|"; within:15; nocase; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,21910; reference:cve,2007-0104; reference:url,projects.info-pull.com/moab/MOAB-06-01-2007.html; classtype:attempted-user; sid:17361; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat JavaScript getIcon method buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|55 1E 42 91 74 A1 4A FA 21 C7 DB 53 14 DE DE 9E A4 6A CD ED 29 C7 4E DE 9E BC ED 49 B3 35 11 D6|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,34169; reference:cve,2009-0927; classtype:attempted-user; sid:17471; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Adobe Reader U3D RHAdobeMeta Buffer Overflow"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|3C 3C 2F|Subtype|2F|U3D|2F|Length"; nocase; content:"|48 89 EC 55 7B 4C 53 69 16 BF 3C 2C F4 21 A0 C2|"; content:"|95 96 0B 5C 0A 22 BD 76 78 8A D8 5A 40 1E 22 2D|"; within:16; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,35282; reference:cve,2009-1855; classtype:attempted-user; sid:17526; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat JavaScript getIcon method buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|B3 2E 86 F7 BA C8 F4 4A 2B C7 AB 99 E8 6B 72 99 39 40 C7 59 B1 2E C9 D1 AE 0C 6E 39 A8 E5 DC 60|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,34169; reference:cve,2009-0927; classtype:attempted-user; sid:17472; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader and Acrobat util.printf buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|2F|S|2F|JavaScript|2F|JS"; nocase; content:"|ED 54 CB 6E 13 41 10 BC FB 2B 46 91 AC D8 72 88|"; distance:0; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2008-2992; classtype:attempted-user; sid:18596; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed TIFF remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"jNLjwFWnTvuP9HG9OL+q916q915//n</image"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-0188; reference:url,www.adobe.com/support/security/bulletins/apsb10-07.html; classtype:attempted-user; sid:18585; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/FontDescriptor"; content:"/Length1 65932"; distance:0; content:"|78 9C EC BD 09 78 54 45 F6 38 5A 75 EB AE BD 77 27 9D 7D E9 EC 04 02 09 09 5B D8 D2 49 48 20 10 92|"; within:100; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18990; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/FontDescriptor"; content:"/Length1 65932"; distance:0; content:"|78 54 45 F6 38 5A 75 EB AE BD 77 27 9D 7D E9 EC 04 02 09 09 01 C2 96 4E 42 02 81 10 22 84 55 C1 84 6C 04|"; within:100; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18991; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Flash Player memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|63 2F 55 46 28 70 6F 63 2E 73 77 66 29 3E 3E 0D|"; content:"|3C 2F 43 68 65 63 6B 53 75 6D 3C 31 36 43 44 45 32 43 39 44 38 41 44 37 37 30 35 46 41 32 31 36 46 31 33 34 46 41 46 37 38 35 30 3E 2F 43 72 65|"; within:48; distance:112; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:19082; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/FontDescriptor"; content:"/Length1 65932"; distance:0; content:"|78 DA EC BD 09 78 54 45 F6 38 5A 75 EB AE BD 77 27 9D 7D E9 EC 04 02 09 09 5B D8 D2 49 48 20 10 92|"; within:50; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18989; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed U3D integer overflow"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/FlateDecode/Length 96729/Subtype/U3D/Type/3D/VA"; content:"/TYPE/3DView/XN(DefaultView)>>]>>stream|0D 0A 78 DA AC DD 05|"; within:46; distance:114; metadata:service http, service imap, service pop3; reference:cve,2009-3959; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:19117; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader script injection vulnerability"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"(j)"; content:"(a)"; within:10; distance:5; content:"(v)"; within:10; distance:5; fast_pattern; content:"(a)"; within:10; distance:5; content:"(s)"; within:10; distance:5; content:"(c)"; within:10; distance:5; content:"(r)"; within:10; distance:5; content:"(i)"; within:10; distance:5; content:"(p)"; within:10; distance:5; content:"(t)"; within:10; distance:5; metadata:service http, service imap, service pop3; reference:cve,2009-3956; reference:url,www.adobe.com/support/security/bulletins/apsb10-02.html; classtype:attempted-user; sid:19118; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed U3D texture continuation integer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|5C FF FF FF 0C 00 00 00 00 00 00 00 08 00 54 65 78 74 75|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2096; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19248; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Adobe Reader U3D file include overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"CDF1048AB8979121691236CBF4378433"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2094; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19250; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader ICC ProfileDescriptionTag overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|CE 00 07 00 09 00 12 00 04 00 33 64 65 73 63 00 00 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2097; reference:url,www.adobe.com/support/security/bulletins/apsb11-16.html; classtype:attempted-user; sid:19255; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat GDI object leak memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"f = getAnnotRichMedia|28|"; nocase; content:"f = getAnnotRichMedia|28|"; distance:0; nocase; metadata:service http, service imap, service pop3; reference:cve,2011-2439; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20152; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded BMP parsing corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|0E 00 00 C4 0E 00 00 00 40 00 00 00 00 00 00 58 58 58 58 58|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2438; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20169; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader app.openDoc path vulnerability"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|42 23 5E 24 C2 C4 4C 62 36 B1 98 F8 3D B1 9A D8 40 6C 21 BA 88 DD C4 61 E2 18 71 8A F8 92 F8 8E|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-2431; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20142; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat embedded JPEG file APP0 chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|FF E0 00 10 4A 46 49 46 00 01 02 01 00 48 00 48 00 00|"; content:"|D8 02 28 FF E1 FF E2 02 F9 02 46 03 47 05|"; within:100; metadata:service http, service imap, service pop3; reference:cve,2011-2440; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20153; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded PICT parsing corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"PICT"; content:"|00 02 10 80 CC CC 58 58 58 58|"; within:10; distance:13; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2433; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20145; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader glyf composite vulnerability"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|C3 A6 1D 01 00 00 08 D8 00 00 06 31 67 6C 79 66 19 37 28 6D 00 00 0F 09 00 00 01 B0 68 65 61 64|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-2441; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20155; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded PICT parsing corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"PICT"; content:"|00 01 41 41 41 01 41 41 41 01|"; within:10; distance:11; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2435; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20148; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader glyf directory table vulnerability"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|00 18 00 1D 00 23 00 28 00 2E 00 32 00 34 00 38 00 3A 00 3F 00 45 00 49 00 4B 00 50 00 56 00 5B|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-2441; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20154; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded PICT parsing corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"PICT"; content:"|00 02 E0 80 CC CC 58 58 58 58|"; within:10; distance:13; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2434; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20147; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded BMP parsing corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|42 00 00 00 28 00 00 00 AB AA AA 0A 40 00 00 00 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2438; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20171; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded BMP parsing corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|12 0B 00 00 12 0B 00 00 00 01 00 00 00 01 00 00 41 41 41 41 41 41|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2438; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20170; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded PCX parsing corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|20 20 20 0A 0A 05 01 08 00 00 00 00 03 00 FF FF 2C 01 2C 01|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2437; reference:url,www.adobe.com/support/security/bulletins/apsb11-24.html; classtype:attempted-user; sid:20150; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat universal 3D format memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"0EFFEC50|F0 00 00 00 40|"; content:"z|3A 5C|hacking|5C|adobe|5C|u3d|5C|images|5C|one.bmp"; distance:0; nocase; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0599; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18454; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat universal 3D format memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|38 42 50 53 00 01 00 00 00 00 00 00 00 04 00 00|"; depth:16; content:"|00 00 00 00 00 00 00 01 00 02 00 02 00 02 00 02 81 41 81 41 81 41 81 41|"; within:24; distance:16; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0593; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18453; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat Universal 3D stream memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|55 FF FF FF|"; nocase; content:"|FE 00|poc.bmp|20 20 20 20 20 20 20 20 20|"; within:200; nocase; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0592; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18448; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat ICC color integer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|2F|ICCBased"; nocase; content:"id=|22|W5M0MpCehiHzreSzNTczkc9d"; distance:0; nocase; content:"|78 9C 94 DA 07 50 53 5D FB 28 FA A8 28 2A 62 41 11 15 45|"; distance:0; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0598; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18451; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed jpeg2000 superbox attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/JPXDecode"; content:"|92 6A 70 32 68 00 00 00 16 69 68 64 72 00 00 02 57 00 00 03 20 00 10 07 07 01 00 00 00 03 44 70 63 6C 72 00 20 19 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-0602; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18455; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader U3D rgba parsing overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|0E 01 00 00 00 01 0E 01 00 01 00 00 00 FE 00 70 6F 63 2E 72 67 62 61|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0591; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18457; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe JPEG2k uninitialized QCC memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|12 12 E0 0F 12 12 E0 0F 12 12 FF|]|00 16|LL"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2994; classtype:attempted-user; sid:16325; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader and Acrobat malicious TIFF remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|3C 3C 2F 23 34 36 23 36 39 6C 23 37 34 23 36 35 23 37 32 2F|"; content:"stream|0D 0A 78 9C A5 7B|"; nocase; content:"|93 A3|"; within:2; distance:1; content:"|B6 E6 7B FF 8A|"; within:5; distance:1; content:"|B7|"; within:1; distance:2; metadata:service http, service imap, service pop3; reference:cve,2010-0188; reference:url,www.securityfocus.com/bid/38195/exploit; classtype:attempted-user; sid:20577; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader PDF JBIG2 remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; content:"8 0 obj"; pcre:"/^\s*<<\s*/([^>#]*#){9}[^>]*>>\s*stream/smR"; content:"xref|0D 0A|0 9|0D 0A|0000000000 65535 f|0D 0A|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:20575; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader PRC file MarkupLinkedItem arbitrary code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|5B 1D 3E DD 05 78 4B E6 00 00 00 00 98 67 25 46|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-4369; reference:url,www.adobe.com/support/security/bulletins/apsb11-30.html; classtype:attempted-user; sid:20802; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader BMP color unused corruption"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|6D 70 29 3E 3E 0A 65 6E 64 6F 62 6A 0A 32 30 20 30 20 6F 62 6A 0A 3C 3C 2F 53 75 62 74 79 70 65 2F 69 6D 61 67 65 23 32 66 62 6D 70 3E 3E 73 74 72 65 61 6D 0A 42 4D 80 07 00 00 00 00 00 00 76 00 00 00 28 00 00 00 01 00 00 00 01 00 00 00 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-4372; reference:url,www.adobe.com/support/security/bulletins/apsb12-01.html; classtype:attempted-user; sid:20919; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed shading modifier heap corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/U3D"; content:"|C8 FF FF FF 6B 18 21 7C 4E 06 67 20 70 CA AF 30|"; distance:0; metadata:service http, service imap, service pop3; reference:cve,2011-2462; reference:url,osvdb.org/77529; reference:url,www.adobe.com/support/security/advisories/apsa11-04.html; classtype:attempted-user; sid:21253; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF hostile PDF associated with Laik exploit kit"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; content:") /CreationDate (D:20110405234628)>>"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service http, service imap, service pop3; classtype:trojan-activity; sid:21417; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Possible malicious pdf - new pdf exploit"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"NEW PDF EXPLOIT"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:attempted-user; sid:21431; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Possible unknown malicious PDF"; flow:to_client, established; flowbits:isset, file.pdf; file_data; content:"%PDF-1."; fast_pattern:only; content:"new Array"; pcre:"/\d+?(.)\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+/R"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-0188; classtype:attempted-user; sid:21429; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Possible unknown malicious PDF"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; fast_pattern:only; content:"arr=|27|"; pcre:"/\d+?(.)\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+/"; metadata:service http, service imap, service pop3; reference:cve,2010-0188; classtype:attempted-user; sid:21453; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Possible malicious pdf detection - qwe123"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; content:"qwe123"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:trojan-activity; sid:21583; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF PDF obfuscation attempt"; flow:to_client, established; flowbits:isset,file.pdf; file_data; content:"application/x-javascript"; pcre:"/<script.*?(&#\d+\x3b){30}/smi"; metadata:service http, service imap, service pop3; classtype:attempted-user; sid:21582; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader shell metacharacter code execution attempt"; flow:to_server,established; flowbits:isset,smtp.contenttype.attachment; content:"begin|20|"; pcre:"/^begin\s\d+\s[^\s\r\n\t]*\x60/sm"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,10931; reference:cve,2004-0630; classtype:attempted-user; sid:18526; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader and Acrobat authplay.dll vulnerability exploit attempt"; flow:to_client,established; file_data; content:"|43 57 53 09 A2 D2 00 00 78 9C EC BD 79 7C 54 C5 D2 37 DE 7D|"; isdataat:316,relative; content:"|CF E7 77 BC EB 19 53 BF 99 F7 7C FB B8 D4 4B FA 7C EE E7 AC C7 83 AD 58 D8 F3 35 8B A5 1E B4 67 4D EA 3F EE 9E 3F 79 C9 AB ED 63 B6 F4 58 7A 57|"; within:48; distance:316; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:16664; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed FlateDecode colors declaration"; flow:to_client, established; file_data; content:"1073741838"; pcre:"/(C|#43)(o|#6F)(l|#6C)(o|#6F)(r|#72)(s|#73)\s*1073741838/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,36600; reference:cve,2009-3459; classtype:attempted-user; sid:16676; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; file_data; content:"|35 3E 5D 0A 3E 3E 0A 73 74 61 72 74 78 72 65 66 0A 32 34 36 31 32 35 0A 25 25 45 4F 46 0A 0D 0A 25 53 49 47 4E 41 54 55 52 45 3A 20 E2 DA 47 7E AC 80 D7 7E AB 80|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:17233; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader and Acrobat TTF SING table parsing remote code execution attempt"; flow:to_client,established; file_data; content:"10 0 obj"; content:"65932>>"; within:200; content:"|78 9C D4 BD|"; within:50; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43057; reference:cve,2010-2883; reference:url,www.adobe.com/support/security/advisories/apsa10-02.html; classtype:attempted-user; sid:18988; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader malformed BMP RGBQUAD attempt"; flow:to_client, established; flowbits:isset,file.bmp; file_data; content:"BM|37 00 00 00 00 00 00 00 36 04 00 00 28 00 00 00|"; fast_pattern:only; pcre:"/\xFF\x41$/"; metadata:service http, service imap, service pop3; reference:cve,2011-0596; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18450; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader DCT dequantizer memory corruption attempt"; flow:to_client,established; file_data; content:"|FF DB 00 84 00 01 01 01 01 01 01 01 01 01 01 01|"; content:"|FF DA 00 08 01 01 01 06 3F 00 79 4B EA 28 27 1D 16 B6 AA DC 4E 4E 6F 92 38 02 6D CA CE|"; distance:0; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-4370; reference:url,www.adobe.com/support/security/bulletins/apsb12-01.html; classtype:attempted-user; sid:20920; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader javascript toolbar button use after free attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"app|2E|removeToolButton"; fast_pattern:only; content:"app|2E|addToolButton"; nocase; pcre:"/stream\s*?app\x2Eaddtoolbutton\x28\x7B[^\x7d]*?\x09cname\x3A\s*?\x22(?P<buttonname>\w+?)[^\x7D]*?\x09cenable\x3A\s*?\x22app\x2Eremovetoolbutton\x28\x27(?P=buttonname)\x27\x29[^\x7D]*?\x7D\x29\x3B\s*?endstream/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,52949; reference:cve,2012-0775; reference:url,adobe.com/support/security/bulletins/apsb12-08.html; classtype:attempted-user; sid:21881; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded TTF interger overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|00 00 01 85 1F 72 2E 57 CB 5F 0F 3C F5 00 09 08 00 00 00 00 00 A7 BD 1E CF 00 00 00 00 B3 DE E7|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2012-0774; reference:url,www.adobe.com/support/security/bulletins/apsb12-08.html; classtype:attempted-user; sid:21878; rev:2;)
# alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-PDF Adobe Reader msiexec.exe file load exploit attempt"; flow:to_server,established; content:"|FF|SMB|A2 00 00 00 00|"; content:"m|00|s|00|i|00|e|00|x|00|e|00|c|00|.|00|e|00|x|00|e|00 00 00|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2012-0776; reference:url,www.adobe.com/support/security/bulletins/apsb12-08.html; classtype:attempted-user; sid:21858; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-PDF Adobe Reader msiexec.exe file load exploit attempt"; flow:to_server,established; content:"|2F|msiexec.exe"; nocase; http_uri; metadata:service http; reference:cve,2012-0776; reference:url,www.adobe.com/support/security/bulletins/apsb12-08.html; classtype:attempted-user; sid:21859; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader embedded TTF interger overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|02 22 00 0A 01 DA 00 08 02 06 00 08 01 DA 00 08 40 01 00 45 40 01 02 45 63 26 E6 2B B8 00 DC 2B|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-0774; reference:url,www.adobe.com/support/security/bulletins/apsb12-08.html; classtype:attempted-user; sid:22938; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Microsoft Windows kernel-mode drivers core font parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot|file.pdf|file.otf|file.ttf; file_data; content:"hmtx"; content:"cmap"; content:"head"; pcre:"/(cmap|head|hmtx|maxp|name|OS\x2F2|post).{4}([\x80-\xFF]|.{4}[\x80-\xFF])/smi"; metadata:service http, service imap, service pop3; reference:cve,2009-2514; reference:cve,2010-2862; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-065; classtype:attempted-admin; sid:16231; rev:14;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Possible malicious PDF detection - qweqwe="; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"><qwe qweqwe="; metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:trojan-activity; sid:22941; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF EmbeddedFile contained within a PDF"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/EmbeddedFile"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; classtype:trojan-activity; sid:23041; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Unknown malicious PDF - CreationDate"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/CreationDate (D:20120421195855"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:trojan-activity; sid:23044; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Unknown malicious PDF - Title"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Title (0aktEPbG1LcQ9f6d8l32m7gI5eY4)>>"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:trojan-activity; sid:23045; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Unknown malicious PDF - CreationDate"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/CreationDate (D:20100829161936"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:trojan-activity; sid:23043; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Unknown Malicious PDF - CreationDate"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<</Creator(sli)/ModDate(D:20080817171147-07|27|00|27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:attempted-user; sid:23140; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader XDP encoded download attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"JVBERi"; fast_pattern:only; content:"<xdp:xdp"; nocase; content:"<pdf"; distance:0; nocase; content:"<document"; distance:0; nocase; content:"<chunk"; distance:0; nocase; content:"JVBERi"; within:500; nocase; metadata:service http, service imap, service pop3; reference:url,blog.9bplus.com/av-bypass-for-malicious-pdfs-using-xdp; reference:url,partners.adobe.com/public/developer/en/xml/xdp_2.0.pdf; classtype:misc-activity; sid:23166; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Unknown Exploit Kit PDF Drop - sdfsdfsd"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; content:"sdfsdfsdxref"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:trojan-activity; sid:23249; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe flash player newfunction memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:" (lolol|5C|056swf)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1297; classtype:attempted-user; sid:23263; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat JavaScript getIcon method buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|55 1E 42 91 74 A1 4A FA 21 C7 DB 53 14 DE DE 9E A4 6A CD ED 29 C7 4E DE 9E BC ED 49 B3 35 11 D6|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,34169; reference:cve,2009-0927; classtype:attempted-user; sid:23503; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe flash player newfunction memory corruption attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:" (lolol|5C|056swf)"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-1297; classtype:attempted-user; sid:23512; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Microsoft Windows kernel-mode drivers core font parsing integer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"hmtx"; content:"cmap"; content:"hhea"; pcre:"/(cmap|head|hhea|hmtx|maxp|name|OS\x2F2|post).{4}([\x80-\xFF]|.{4}[\x80-\xFF])/s"; metadata:service smtp; reference:cve,2009-2514; reference:cve,2010-2862; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-065; classtype:attempted-admin; sid:23508; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF PDF with click-to-launch executable"; flow:established,to_server; flowbits:isset,file.pdf; file_data; content:"/F"; content:"/Unix"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fUnix\s*\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:23514; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat font parsing integer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|01|pmaxp|02 ED 0A 7B 00 00|p|0E 00 00 00 20|name|EA 2E F3 EE 00 00|p.|00 00 04|aposts|F1|o|84 00 00|t|8F 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,44203; reference:cve,2010-2862; classtype:attempted-user; sid:23507; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Possible unknown malicious PDF"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; fast_pattern:only; content:"arr=|27|"; pcre:"/\d+?(.)\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+/"; metadata:service smtp; reference:cve,2010-0188; classtype:attempted-user; sid:23520; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader libtiff TIFFFetchShortPair stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"stream|0A 78 9C ED 5B 49 73 E2 38 14 BE F7 AF 70 79 6E C3 34 62 87 A4 42 BA C4 36 90 C4 01 C2 9A 5C BA 84 2D 1B 07 DB 32 96 1C 03 BF 7E 24 2F 6C D3 3D 9D C3 54 4D 4D 95 5C F5 81 DE|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2006-3459; reference:cve,2010-0188; classtype:attempted-user; sid:23518; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader libtiff TIFFFetchShortPair stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"stream|0A 78 9C ED 5B 5B 6F E2 38 14 7E EF AF 88 B2 6F CB 0E E6 0E AD 0A 23 73 5B 68 9B 02 E5 DA BE 8C 4C E2 04 97 24 0E B1 D3 00 BF 7E ED 24 B4 94 99 DD 19 69 1F 56 5A 39 D2 07 E7 F6 1D 1F DB 71 9E 7C|"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2006-3459; reference:cve,2010-0188; classtype:attempted-user; sid:23517; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader malformed TIFF remote code execution attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|EB|/|ED|Z|B9|qX|F4 D8|C|F5|a|BF|+|0D 8C D2 F3 DD|*|EE 09|W|B1 B3 9B|P|EB AD D1 B3 07 A0|4|D8|m|7C 7F EB B5 EF|j|E8 F5|m[+t|8F 7C BC|f|BB 86|ql|F7 C0 C3 E8|"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:cve,2010-0188; reference:url,www.adobe.com/support/security/bulletins/apsb10-07.html; classtype:attempted-user; sid:23524; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF PDF with click-to-launch executable"; flow:established,to_server; flowbits:isset,file.pdf; file_data; content:"/F"; content:"/Mac"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fMac\s*\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:23513; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader media.newPlayer memory corruption attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/S/JavaScript"; content:"this.media.newPlayer"; pcre:"/^\x5C?\x28null\x5C?\x29/R"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,37331; reference:cve,2009-4324; classtype:attempted-user; sid:23506; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader compressed media.newPlayer memory corruption attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"&|EA A7 7C 9A 1D C4 1C FE|&|7F|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:cve,2009-4324; classtype:attempted-user; sid:23505; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader File containing Flash use-after-free attack attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|3C 3C 2F 46 69 6C 74 65 72 2F 46 6C 61 74 65 44 65 63 6F 64 65 2F 46 69 72 73 74 20 39 39 2F 4C 65 6E 67 74 68 20 35 31 31 2F 4E 20 31 35 2F 54 79 70 65 2F 4F 62 6A 53 74 6D 3E 3E 73 74 72 65 61 6D 0D 0A 68 DE 6C 52 DB 6E E2 30|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-1297; classtype:attempted-user; sid:23510; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat JavaScript getIcon method buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|B3 2E 86 F7 BA C8 F4 4A 2B C7 AB 99 E8 6B 72 99 39 40 C7 59 B1 2E C9 D1 AE 0C 6E 39 A8 E5 DC 60|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,34169; reference:cve,2009-0927; classtype:attempted-user; sid:23502; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF PDF with click-to-launch executable"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/La"; within:100; nocase; content:"/F"; pcre:"/\/La(.)*?\s*?\/F[^\/>]+\.(exe|dll|com|swf)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:23516; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader malformed TIFF remote code execution attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"jNLjwFWnTvuP9HG9OL+q916q915//n</image"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-0188; reference:url,www.adobe.com/support/security/bulletins/apsb10-07.html; classtype:attempted-user; sid:23523; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader javascript getIcon method buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"Collab.getIcon"; fast_pattern:only; pcre:!"/Collab\.getIcon[^\x28]*?\x28\s*([\x22\x27])[^\1]{1,256}\1\s*\x29/smi"; metadata:policy security-ips drop, service smtp; reference:bugtraq,34169; reference:cve,2009-0927; classtype:attempted-user; sid:23501; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader spell.customDictionaryOpen exploit attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"spell.customDictionaryOpen|5C|(0,dict|5C|)"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:bugtraq,34740; reference:cve,2009-1493; classtype:attempted-user; sid:23500; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader getAnnots exploit attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"getAnnots"; nocase; pcre:"/getAnnots\x5C?\([^\x29\x2C]+\x2C\s*[^\x29\x2C]+\x2C\s*[^\x29\x2C]+\x2C\s*-\d/smi"; metadata:policy security-ips drop, service smtp; reference:bugtraq,34736; reference:cve,2009-1492; classtype:attempted-user; sid:23504; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader and Acrobat authplay.dll vulnerability exploit attempt"; flow:to_server,established; file_data; content:"|43 57 53 09 A2 D2 00 00 78 9C EC BD 79 7C 54 C5 D2 37 DE 7D|"; isdataat:316,relative; content:"|CF E7 77 BC EB 19 53 BF 99 F7 7C FB B8 D4 4B FA 7C EE E7 AC C7 83 AD 58 D8 F3 35 8B A5 1E B4 67 4D EA 3F EE 9E 3F 79 C9 AB ED 63 B6 F4 58 7A 57|"; within:48; distance:316; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,40586; reference:cve,2010-1297; classtype:attempted-user; sid:23511; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Possible unknown malicious PDF"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; fast_pattern:only; content:"new Array"; pcre:"/\d+?(.)\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+\1\d+/"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-0188; classtype:attempted-user; sid:23521; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader malformed Richmedia annotation exploit attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Subtype/RichMedia"; fast_pattern:only; content:"/Annot"; pcre:"/\/Rect\s*\[[^\]]*\./"; metadata:policy security-ips drop, service smtp; reference:cve,2010-0197; reference:cve,2010-1297; classtype:attempted-admin; sid:23509; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF PDF with click-to-launch executable"; flow:established,to_server; flowbits:isset,file.pdf; file_data; content:"/F"; content:"/DOS"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fDOS\s*\x28/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:23515; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader and Acrobat malicious TIFF remote code execution attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|3C 3C 2F 23 34 36 23 36 39 6C 23 37 34 23 36 35 23 37 32 2F|"; content:"stream|0D 0A 78 9C A5 7B|"; nocase; content:"|93 A3|"; within:2; distance:1; content:"|B6 E6 7B FF 8A|"; within:5; distance:1; content:"|B7|"; within:1; distance:2; metadata:service smtp; reference:cve,2010-0188; reference:url,www.securityfocus.com/bid/38195/exploit; classtype:attempted-user; sid:23522; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF JavaScript contained in an xml template embedded in a pdf attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<template xmlns="; content:"http|3A|//www.xfa.org/"; distance:1; content:"<event activity"; distance:0; content:"initialize"; within:50; distance:1; content:"application/x-javascript"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1525; reference:cve,2012-1530; reference:url,prosauce.org/blog/2010/08/analyzing-cve-2010-0188-exploits-the-legend-of-pat-casey-part-1/; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; reference:url,www.thebaskins.com/main/component/content/article/15-work/58-malicious-pdf-analysis-reverse-code-obfuscation; reference:url,www.virustotal.com/file/ECA91825CA5CF6D8C06815CB471A0968F540878121CB13F971FD45C3EA3EBBAC/analysis/; classtype:trojan-activity; sid:23612; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF JavaScript contained in an xml template embedded in a pdf attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"<template xmlns="; content:"http|3A|//www.xfa.org/"; distance:1; content:"<event activity"; distance:0; content:"initialize"; within:50; distance:1; content:"application/x-javascript"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1525; reference:url,prosauce.org/blog/2010/08/analyzing-cve-2010-0188-exploits-the-legend-of-pat-casey-part-1/; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; reference:url,www.thebaskins.com/main/component/content/article/15-work/58-malicious-pdf-analysis-reverse-code-obfuscation; reference:url,www.virustotal.com/file/ECA91825CA5CF6D8C06815CB471A0968F540878121CB13F971FD45C3EA3EBBAC/analysis/; classtype:trojan-activity; sid:23611; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader invalid inline image attempt"; flow:to_server,established; file_data; flowbits:isset,file.pdf; content:"BI|0A|"; content:"/ColorSpace"; within:100; pcre:"/^\s*?[^(ID)]\d/R"; content:"ID"; distance:0; content:"|0A|EI|20 20|"; distance:0; metadata:policy security-ips drop, service smtp; reference:cve,2012-4151; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23871; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader postscript font execution malformed subroutine entries attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|1D CD 77 ED B6 D2 C2 E2 FD 7A C5 C0 EE FE AC A0 11 ED 3B 6A 90 84 3B CA A8 49 3E E9 9E 59 63 1E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4152; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23874; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader invalid font WeightVector attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"obj"; content:"%!PS"; distance:0; content:"Blend"; distance:0; content:"|0D 2F|Weight"; distance:0; content:!"Vector ["; within:8; metadata:policy security-ips drop, service smtp; reference:cve,2012-4152; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23865; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader getAnnotsRichMedia return type confusion attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"<</Type/PROJCS"; fast_pattern; content:"/WKT|28|"; within:15; isdataat:1024,relative; pcre:"/^[^>]{1024}/Rms"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2050; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-dos; sid:23891; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader invalid inline image attempt"; flow:to_client,established; file_data; flowbits:isset,file.pdf; content:"BI|0A|"; content:"/ColorSpace"; within:100; pcre:"/^\s*?[^(ID)]\d/R"; content:"ID"; distance:0; content:"|0A|EI|20 20|"; distance:0; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4151; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23870; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adober Reader JBIG2 encoding invalid symbol in dictionary segment"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"%PDF-1.4"; content:">>stream"; content:"|00 01 00 00 FF FB FF FF FF FF FF FF FF FF FF FF|"; within:512; metadata:service http, service imap, service pop3; reference:cve,2012-4150; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-admin; sid:23883; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader Texture Declaration buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"stream|0A|U3D"; fast_pattern:only; content:"|14 FF FF FF|"; content:"|55 FF FF FF|"; distance:0; byte_jump:2,8,relative,little,post_offset 9; byte_test:4,>=,0x1,0,relative,little; content:"|00 0E 01 00|"; within:4; distance:4; byte_test:2,>,0x260,4,relative,little; metadata:policy balanced-ips alert, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-2049; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-user; sid:23879; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader invalid inline image attempt"; flow:to_client,established; file_data; flowbits:isset,file.pdf; content:"|30 34 9C 17 0E D6 9C 3D 64 EC E2 A4 D2 E0 7F EA FC DA 2E 70 CF D7 15 4E AC D7 11 7D 2F 94 6B 8E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4151; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23868; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader getAnnotsRichMedia return type confusion attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Type /Annot|0A|"; nocase; content:"/Subtype/RichMedia"; distance:0; nocase; content:"getAnnotsRichMedia|28|"; fast_pattern:only; pcre:"/var (?P<var>\w+)\s*=\s*getAnnotsRichMedia\x28.*?(?P=var)\.(pop|shift).*?>> endobj/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4147; classtype:attempted-dos; sid:23882; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader invalid inline image attempt"; flow:to_server,established; file_data; flowbits:isset,file.pdf; content:"BI|0A|"; content:"/CS"; within:100; pcre:"/^\s*?[^(ID)]\d/R"; content:"ID"; distance:0; content:"|0A|EI|20 20|"; distance:0; metadata:policy security-ips drop, service smtp; reference:cve,2012-4151; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23867; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader getAnnotsRichMedia return type confusion attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<</Type/PROJCS"; fast_pattern; content:"/WKT|28|"; within:15; isdataat:1024,relative; pcre:"/^[^>]{1024}/Rms"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-2050; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-dos; sid:23889; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader getAnnotsRichMedia return type confusion attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<</Type/GEOGCS"; fast_pattern; content:"/WKT|28|"; within:15; isdataat:1024,relative; pcre:"/^[^>]{1024}/Rms"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-2050; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-dos; sid:23890; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Blackhole related malicious file detection"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; depth:7; content:"<</Creator("; distance:0; nocase; pcre:"/<<\x2fCreator\x28\d{2,3}(.)\d{2,3}\1\d{2,3}\1\d{2,3}\1/smi"; content:")/ModDate"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; classtype:trojan-activity; sid:23852; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader getAnnotsRichMedia return type confusion attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Type /Annot|0A|"; nocase; content:"/Subtype/RichMedia"; distance:0; nocase; content:"getAnnotsRichMedia|28|"; fast_pattern:only; pcre:"/var (?P<var>\w+)\s*=\s*getAnnotsRichMedia\x28.*?(?P=var)\.(pop|shift).*?>> endobj/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4147; classtype:attempted-dos; sid:23881; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader invalid inline image attempt"; flow:to_server,established; file_data; flowbits:isset,file.pdf; content:"|30 34 9C 17 0E D6 9C 3D 64 EC E2 A4 D2 E0 7F EA FC DA 2E 70 CF D7 15 4E AC D7 11 7D 2F 94 6B 8E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4151; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23869; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader invalid font WeightVector attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"obj"; content:"%!PS"; distance:0; content:"Blend"; distance:0; content:"|0D 2F|Weight"; distance:0; content:!"Vector ["; within:8; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4152; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23864; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader invalid inline image attempt"; flow:to_client,established; file_data; flowbits:isset,file.pdf; content:"BI|0A|"; content:"/CS"; within:100; pcre:"/^\s*?[^(ID)]\d/R"; content:"ID"; distance:0; content:"|0A|EI|20 20|"; distance:0; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4151; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23866; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Blackhole related malicious file detection"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; depth:7; content:"<</Creator("; distance:0; nocase; pcre:"/<<\x2fCreator\x28\d{2,3}(.)\d{2,3}\1\d{2,3}\1\d{2,3}\1/smi"; content:")/ModDate"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:trojan-activity; sid:23851; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader Texture Declaration buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"stream|0A|U3D"; fast_pattern:only; content:"|14 FF FF FF|"; content:"|55 FF FF FF|"; distance:0; byte_jump:2,8,relative,little,post_offset 9; byte_test:4,>=,0x1,0,relative,little; content:"|00 0E 01 00|"; within:4; distance:4; byte_test:2,>,0x260,4,relative,little; metadata:policy balanced-ips alert, policy security-ips drop, service smtp; reference:cve,2012-2049; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-user; sid:23880; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader getAnnotsRichMedia return type confusion attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"<</Type/GEOGCS"; fast_pattern; content:"/WKT|28|"; within:15; isdataat:1024,relative; pcre:"/^[^>]{1024}/Rms"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-2050; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-dos; sid:23892; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader postscript font execution malformed subroutine entries attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|1D CD 77 ED B6 D2 C2 E2 FD 7A C5 C0 EE FE AC A0 11 ED 3B 6A 90 84 3B CA A8 49 3E E9 9E 59 63 1E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4152; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:23875; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adober Reader JBIG2 encoding invalid symbol in dictionary segment"; flow:established,to_server; flowbits:isset,file.pdf; file_data; content:"%PDF-1.4"; content:">>stream"; content:"|00 01 00 00 FF FB FF FF FF FF FF FF FF FF FF FF|"; within:512; metadata:service smtp; reference:cve,2012-4150; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-admin; sid:23884; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader collab.collectEmailInfo exploit attempt"; flow:to_client,established; file_data; content:"collab.collectEmailInfo"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,27641; reference:cve,2007-5659; reference:cve,2008-0655; classtype:attempted-user; sid:13478; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader collab.collectEmailInfo exploit attempt - compressed"; flow:to_client,established; file_data; content:"|F7 C5|d|F2 F8 F9|e|B7 EF 8B E9 AF BF F2|@|F1 FB FB A2 9C D9 B3 FB F7 05 CE|>|1E FB F3 E5|x|28|>=~-|B6|Y|DA E9 BC|9|9E A7|&|E6 F4|l2|8A CB|"; metadata:policy security-ips drop, service http; reference:bugtraq,27641; reference:cve,2008-0655; classtype:attempted-user; sid:13477; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader Javascript buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<826D67E8A5B1CA4FB"; fast_pattern; content:"<471523284C528D4D9BFB27665CACF0C0>"; distance:0; nocase; content:"|5D 6F DC B8 F1 AF 08 06 7C F0 D6 97 1C 29 92 12|"; distance:0; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2007-5659; classtype:attempted-user; sid:23899; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader Javascript buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"<826D67E8A5B1CA4FB"; fast_pattern; content:"<471523284C528D4D9BFB27665CACF0C0>"; distance:0; nocase; content:"|5D 6F DC B8 F1 AF 08 06 7C F0 D6 97 1C 29 92 12|"; distance:0; metadata:policy security-ips drop, service smtp; reference:cve,2007-5659; classtype:attempted-user; sid:23900; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader collab.collectEmailInfo exploit attempt"; flow:to_server,established; file_data; content:"collab.collectEmailInfo"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:bugtraq,27641; reference:cve,2007-5659; reference:cve,2008-0655; classtype:attempted-user; sid:23898; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader Javascript buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"Producer (Python PDF Library |5C|055 http"; fast_pattern; content:"|57 E3 00 41 90 43 4E 39 64 6F 41 0E 24 9B 1C 6B|"; within:800; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2007-5659; classtype:attempted-user; sid:23901; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Sending of a PDF with embedded JavaScript - JS string attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/JS"; distance:0; fast_pattern; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*?\x2fJS[\s<>]/smi"; metadata:service smtp; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:23897; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader Javascript buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"Producer (Python PDF Library |5C|055 http"; fast_pattern; content:"|57 E3 00 41 90 43 4E 39 64 6F 41 0E 24 9B 1C 6B|"; within:800; metadata:policy security-ips drop, service smtp; reference:cve,2007-5659; classtype:attempted-user; sid:23902; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-PDF CUPS and Xpdf JBIG2 symbol dictionary buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"JBIG2Decode"; content:"|03 FF FD FF 02 FE FE FE 00 00 00 36 FF FF FF F0 94 6B 62 1B|"; within:1000; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2009-0195; reference:url,www.cups.org/str.php?L3129; classtype:attempted-user; sid:17641; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader JBIG2 remote code execution attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"JBIG2Decode"; nocase; content:"stream"; distance:0; nocase; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/si"; byte_test:1,&,0x40,4,relative; byte_test:1,!&,128,4,relative; byte_test:1,!&,32,4,relative; byte_test:1,=,0,5,relative; byte_test:4,>,0x1000,6,relative,big; metadata:policy security-ips drop, service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15358; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader JBIG2 remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"JBIG2Decode"; nocase; content:"stream"; distance:0; nocase; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/si"; byte_test:1,&,0x40,4,relative; byte_test:1,!&,128,4,relative; byte_test:1,!&,32,4,relative; byte_test:1,=,0,5,relative; byte_test:4,>,0x1000,6,relative,big; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15357; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader PDF JBIG2 remote code execution attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"8 0 obj"; pcre:"/^\s*<<\s*/([^>#]*#){9}[^>]*>>\s*stream/smR"; content:"xref|0D 0A|0 9|0D 0A|0000000000 65535 f|0D 0A|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:24124; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat Reader malicious charstring stream attempt"; flow:to_server,established; file_data; content:"|F7 0F 8E 10 DF 11 F0 13 0F 14 58 15 4D 16 7E 17 A6 19 15 1A 8C 1B 8E 1C E4 1E 2B 1F 13 20 26 22 04 24 1B 25 53 25 B3 26 A4 27 F8 28 D4 29 E0 2A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4159; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-user; sid:24149; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader embedded TTF bytecode memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|2C 23 4B 54 58 20 20 60 B0 01 60 25 8A 38 1B 23 21 59 B8 FF FF 62 2D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,55015; reference:cve,2012-4154; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-user; sid:24152; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat Reader malicious charstring stream attempt"; flow:to_client,established; file_data; content:"|F7 0F 8E 10 DF 11 F0 13 0F 14 58 15 4D 16 7E 17 A6 19 15 1A 8C 1B 8E 1C E4 1E 2B 1F 13 20 26 22 04 24 1B 25 53 25 B3 26 A4 27 F8 28 D4 29 E0 2A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4159; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-user; sid:24148; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat Reader free text annotation invalid IT value denial of service attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Type"; content:"/Annot"; within:10; content:"/Subtype"; distance:0; content:"/FreeText"; within:15; content:"/IT/"; distance:0; pcre:!"/\s\x2fIT\x2fFreeText(Typewriter|Callout|)\s/"; metadata:service http, service imap, service pop3; reference:cve,2012-4149; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:trojan-activity; sid:24154; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat Reader TrueType font corrupt header attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|00 00 00 02 00 01 00 00 00 00 00 14 00 03 00 00 00 00 01 1A|"; byte_jump:4,0,relative,post_offset -4; content:"|00 0C 00 52|"; within:4; byte_test:4,<,0x10,0,relative; metadata:policy security-ips drop, service smtp; reference:cve,2012-4157; reference:url,www.adobe.com/support/security/advisories/apsa12-16.html; classtype:attempted-user; sid:24151; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat Reader free text annotation invalid IT value denial of service attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Type"; content:"/Annot"; within:10; content:"/Subtype"; distance:0; content:"/FreeText"; within:15; content:"/IT/"; distance:0; pcre:!"/\s\x2fIT\x2fFreeText(Typewriter|Callout|)\s/"; metadata:service smtp; reference:cve,2012-4149; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:trojan-activity; sid:24155; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader embedded TTF bytecode memory corruption attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|2C 23 4B 54 58 20 20 60 B0 01 60 25 8A 38 1B 23 21 59 B8 FF FF 62 2D|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,55015; reference:cve,2012-4154; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:attempted-user; sid:24153; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat Reader TrueType font corrupt header attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|00 00 00 02 00 01 00 00 00 00 00 14 00 03 00 00 00 00 01 1A|"; byte_jump:4,0,relative,post_offset -4; content:"|00 0C 00 52|"; within:4; byte_test:4,<,0x10,0,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4157; reference:url,www.adobe.com/support/security/advisories/apsa12-16.html; classtype:attempted-user; sid:24150; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Blackberry Server PDF JBIG2 numnewsyms remote code execution attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"JBIG2Decode"; nocase; content:"stream"; distance:0; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/smi"; byte_test:1, !&, 63, 4, relative; byte_test:4, >, 2147483647, 17, relative; metadata:service http, service imap, service pop3; reference:bugtraq,35102; reference:cve,2009-2643; reference:url,www.blackberry.com/btsc/search.do?cmd=displayKC&docType=kc&externalId=KB18327; classtype:attempted-admin; sid:16336; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF XPDF ObjectStream integer overflow"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"Type/ObjStm"; nocase; pcre:"/Type\x2FObjStm[^>]*?\x2FN\s+\d{7}/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,36703; reference:bugtraq,37167; reference:cve,2009-3608; classtype:attempted-user; sid:16335; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF xpdf ObjectStream integer overflow"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"Type/ObjStm"; nocase; pcre:"/Type\x2FObjStm[^>]*?\x2FN\s+\d{7}/smi"; metadata:policy security-ips drop, service smtp; reference:bugtraq,36703; reference:bugtraq,37167; reference:cve,2009-3608; classtype:attempted-user; sid:24266; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Overly large CreationDate within a pdf - likely malicious"; flow:to_server,established; flowbits:isset,file.pdf; content:"/CreationDate("; isdataat:500,relative; content:")>>"; distance:0; pcre:"/CreationDate[^\x3c\x29]{500}/"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; classtype:misc-activity; sid:24264; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Overly large CreationDate within a pdf - likely malicious"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/CreationDate("; isdataat:500,relative; content:")>>"; distance:0; pcre:"/CreationDate[^\x3c\x29]{500}/"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:misc-activity; sid:24263; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Microsoft Windows kernel-mode drivers core font parsing integer overflow attempt"; flow:to_server,established; flowbits:isset,file.eot|file.pdf|file.otf|file.ttf; file_data; content:"OTTO"; content:"hmtx"; content:"cmap"; content:"hhea"; content:!"hhea"; within:20; byte_test:4,>=,0x80000000,4,relative; metadata:service smtp; reference:cve,2009-2514; reference:cve,2010-2862; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-065; classtype:attempted-admin; sid:24486; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Microsoft Windows kernel-mode drivers core font parsing integer overflow attempt"; flow:to_server,established; flowbits:isset,file.eot|file.pdf|file.otf|file.ttf; file_data; content:"hmtx"; content:"cmap"; content:"head"; pcre:"/(cmap|head|hmtx|maxp|name|OS\x2F2|post).{4}([\x80-\xFF]|.{4}[\x80-\xFF])/s"; metadata:service smtp; reference:cve,2009-2514; reference:cve,2010-2862; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-065; classtype:attempted-admin; sid:24487; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Microsoft Windows kernel-mode drivers core font parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot|file.pdf|file.otf|file.ttf; file_data; content:"OTTO"; content:"hmtx"; content:"cmap"; content:"hhea"; content:!"hhea"; within:20; byte_test:4,>=,0x80000000,4,relative; metadata:service http, service imap, service pop3; reference:cve,2009-2514; reference:cve,2010-2862; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-065; classtype:attempted-admin; sid:24485; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader null pointer dereference attempt"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"/FT"; pcre:"/^\s+\/(?!Btn|Tx|Ch|Sig)/R"; content:"/Subtype"; within:200; distance:-100; content:"/Widget"; within:8; fast_pattern; metadata:service http, service imap, service pop3; reference:cve,2012-4148; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; classtype:denial-of-service; sid:24506; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Microsoft Windows kernel-mode drivers core font parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot|file.pdf|file.otf|file.ttf; file_data; content:"|00 01 00 00|"; byte_test:2,>,0xfff8,6,relative; metadata:service http, service imap, service pop3; reference:cve,2010-2862; classtype:attempted-admin; sid:24507; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Microsoft Windows kernel-mode drivers core font parsing integer overflow attempt"; flow:to_server,established; flowbits:isset,file.eot|file.pdf|file.otf|file.ttf; file_data; content:"|00 01 00 00|"; byte_test:2,>,0xfff8,6,relative; metadata:service smtp; reference:cve,2010-2862; classtype:attempted-admin; sid:24508; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Sophos Antivirus PDF parsing stack overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; nocase; content:"|49 92 24 49 92 24 49 92 24 49 92 24 49 92 24 49 92 24 49 92 24 49 92 24 49 92 24|"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,lock.cmpxchg8b.com/sophailv2.pdf; reference:url,nakedsecurity.sophos.com/2012/11/05/tavis-ormandy-sophos/; classtype:attempted-user; sid:24626; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Sophos Antivirus PDF parsing stack overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1."; nocase; content:"|49 92 24 49 92 24 49 92 24 49 92 24 49 92 24 49 92 24 49 92 24 49 92 24 49 92 24|"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,lock.cmpxchg8b.com/sophailv2.pdf; reference:url,nakedsecurity.sophos.com/2012/11/05/tavis-ormandy-sophos/; classtype:attempted-user; sid:24625; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader empty object page tree node reference attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Pages"; nocase; content:"/XObject"; nocase; content:"/Subtype "; distance:0; nocase; pcre:"/obj\s*?<<[^>]*?\/Pages\s+?(?P<ref>\d+)\s+?\d+?\s+?R[^>]*?>>.*?(?P=ref)\s+?\d+?\s+?obj\s*?<<\s*?>>\s*?endobj/si"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,group-ib.com/index.php/7-novosti/672-group-ib-us-zero-day-vulnerability-found-in-adobe-x; classtype:attempted-user; sid:24721; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader empty object page tree node reference attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Pages"; nocase; content:"/XObject"; nocase; content:"/Subtype "; distance:0; nocase; pcre:"/obj\s*?<<[^>]*?\/Pages\s+?(?P<ref>\d+)\s+?\d+?\s+?R[^>]*?>>.*?(?P=ref)\s+?\d+?\s+?obj\s*?<<\s*?>>\s*?endobj/si"; metadata:policy security-ips drop, service smtp; reference:url,group-ib.com/index.php/7-novosti/672-group-ib-us-zero-day-vulnerability-found-in-adobe-x; classtype:attempted-user; sid:24722; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Sophos Antivirus PDF parsing stack overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"<</Filter"; nocase; content:"/Standard"; within:15; fast_pattern; nocase; content:"/Length"; within:15; nocase; byte_test:10,>,256,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,lock.cmpxchg8b.com/sophailv2.pdf; reference:url,nakedsecurity.sophos.com/2012/11/05/tavis-ormandy-sophos/; classtype:attempted-user; sid:24764; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Sophos Antivirus PDF parsing stack overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"<</Filter"; nocase; content:"/Standard"; within:15; fast_pattern; nocase; content:"/Length"; within:15; nocase; byte_test:10,>,256,0,relative,string; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,lock.cmpxchg8b.com/sophailv2.pdf; reference:url,nakedsecurity.sophos.com/2012/11/05/tavis-ormandy-sophos/; classtype:attempted-user; sid:24763; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat Reader structtreeroot children recursive call denial of service attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|0A 73 74 72 65 61 6D 0D 0A 78 9C BD 57 4D 6F DB 48 0C BD 2F B0 FF 81 C7 EC 49 F3 FD 01 14 05 D2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0626; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:denial-of-service; sid:25469; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF OpenType parsing buffer overflow attempt"; flow:to_client, established; flowbits:isset,file.pdf; file_data; content:"/Type /Font|0A|/Subtype /TrueType|0A|"; content:"ttcf"; distance:0; byte_test:4,>,0x40000000,4,relative; metadata:policy balanced-ips drop, service http, service imap, service pop3; reference:cve,2013-0604; classtype:attempted-user; sid:25461; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Javascript openDoc UNC network request attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:".openDoc("; distance:0; nocase; content:"cPath:"; distance:0; nocase; content:"|5C 5C 5C 5C|"; within:7; metadata:service smtp; reference:cve,2013-0622; reference:url,www.adobe.com/devnet/acrobat/javascript.html; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:policy-violation; sid:25450; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat Reader structtreeroot children recursive call denial of service attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/StructTreeRoot"; fast_pattern:only; pcre:"/obj\s*?(?P<objnum>\d*).*?\x2fK(ids)?\s*?\x5b\s*?(?P=objnum)\s*?0\s*?R/si"; metadata:service smtp; reference:cve,2013-0626; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:denial-of-service; sid:25468; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF OpenType parsing buffer overflow attempt"; flow:to_server, established; flowbits:isset,file.pdf; file_data; content:"|F1 B2 8D 48 25 6C 36 DB 82 24 D0 62 42 42 82 B4 26 B0 01 95|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:cve,2013-0604; classtype:attempted-user; sid:25464; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader incomplete JP2K image geometry - potentially malicious"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"jp2c|FF 4F FF 51|"; byte_extract:4,4,xsiz,relative; byte_test:4,<,xsiz,12,relative; metadata:policy security-ips alert, service smtp; reference:cve,2013-0621; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:attempted-user; sid:25460; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat Reader structtreeroot children recursive call denial of service attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|0A 73 74 72 65 61 6D 0D 0A 78 9C BD 57 4D 6F DB 48 0C BD 2F B0 FF 81 C7 EC 49 F3 FD 01 14 05 D2|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2013-0626; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:denial-of-service; sid:25467; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF JavaScript contained in an xml template embedded in a pdf attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"<template xmlns="; content:"http|3A|//www.xfa.org/"; distance:1; content:"<event activity"; distance:0; content:"initialize"; within:50; distance:1; content:"application/x-javascript"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-1525; reference:cve,2012-1530; reference:url,prosauce.org/blog/2010/08/analyzing-cve-2010-0188-exploits-the-legend-of-pat-casey-part-1/; reference:url,www.adobe.com/support/security/bulletins/apsb12-16.html; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; reference:url,www.thebaskins.com/main/component/content/article/15-work/58-malicious-pdf-analysis-reverse-code-obfuscation; reference:url,www.virustotal.com/file/ECA91825CA5CF6D8C06815CB471A0968F540878121CB13F971FD45C3EA3EBBAC/analysis/; classtype:trojan-activity; sid:25475; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF OpenType parsing buffer overflow attempt"; flow:to_server, established; flowbits:isset,file.pdf; file_data; content:"/Type /Font|0A|/Subtype /TrueType|0A|"; content:"ttcf"; distance:0; byte_test:4,>,0x40000000,4,relative; metadata:policy balanced-ips drop, service smtp; reference:cve,2013-0604; classtype:attempted-user; sid:25463; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Javascript openDoc UNC network request attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:".openDoc("; distance:0; nocase; content:"cPath:"; distance:0; nocase; content:"|5C 5C 5C 5C|"; within:7; metadata:service http, service imap, service pop3; reference:cve,2013-0622; reference:url,www.adobe.com/devnet/acrobat/javascript.html; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:policy-violation; sid:25449; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Acrobat Reader structtreeroot children recursive call denial of service attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/StructTreeRoot"; fast_pattern:only; pcre:"/obj\s*?(?P<objnum>\d*).*?\x2fK(ids)?\s*?\x5b\s*?(?P=objnum)\s*?0\s*?R/si"; metadata:service http, service imap, service pop3; reference:cve,2013-0626; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:denial-of-service; sid:25466; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader incomplete JP2K image geometry - potentially malicious"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"jp2c|FF 4F FF 51|"; byte_extract:4,4,xsiz,relative; byte_test:4,<,xsiz,12,relative; metadata:policy security-ips alert, service http, service imap, service pop3; reference:cve,2013-0621; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:attempted-user; sid:25459; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF OpenType parsing buffer overflow attempt"; flow:to_client, established; flowbits:isset,file.pdf; file_data; content:"|F1 B2 8D 48 25 6C 36 DB 82 24 D0 62 42 42 82 B4 26 B0 01 95|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2013-0604; classtype:attempted-user; sid:25462; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader TTF parsing bad cmap format attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|BB 09 74 1C D5 9D FF FB BB 55 DD 5D D5 DD D5 DD|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2013-0623; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:attempted-user; sid:25536; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader TTF parsing bad cmap format attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|BB 09 74 1C D5 9D FF FB BB 55 DD 5D D5 DD D5 DD|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:cve,2013-0623; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:attempted-user; sid:25537; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader heap-based buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"|FF DA 00 0C 03 02 00 02 11 03 11 00 3F 00 F4 E4 92 49 25 29|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2013-0604; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:attempted-user; sid:25563; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader heap-based buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; content:"|FF DA 00 0C 03 02 00 02 11 03 11 00 3F 00 F4 E4 92 49 25 29|"; fast_pattern:only; metadata:policy security-ips drop, service smtp; reference:cve,2013-0604; reference:url,www.adobe.com/support/security/bulletins/apsb13-02.html; classtype:attempted-user; sid:25564; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader FlateDecode integer overflow attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/DecodeParms"; content:"/Predictor"; distance:0; byte_test:4,>,1,1,relative,string,dec; pcre:"/\x2fDecodeParms\s*\x3c{2}\s*(?=[^\x3e]*\/Predictor\s+0*(1\d{1}|[2-9]))([^\x3e]*\x2fBitsPerComponent\s+\d{3}|[^\x3e]*\x2fColumns\s+\d{5}|[^\x3e]*\x2fColors\s+\d{5})/"; metadata:policy security-ips drop, service smtp; reference:bugtraq,35294; reference:bugtraq,36600; reference:cve,2009-1856; reference:cve,2009-3459; classtype:attempted-user; sid:25588; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-PDF Acrobat Reader plugin bibutils.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|bibutils.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18441; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-PDF Acrobat Reader plugin cooltype.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|cooltype.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18442; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-PDF Acrobat Reader plugin sqlite.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|sqlite.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18431; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-PDF Acrobat Reader d3dref9.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|d3dref9.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0588; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18432; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-PDF Acrobat Reader plugin cryptocme2.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|cryptocme2.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18443; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-PDF Acrobat Reader plugin ace.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|ace.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18439; rev:10;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-PDF Acrobat Reader plugin agm.dll dll-load exploit attempt"; flow:to_server,established; content:"|2F|agm.dll"; nocase; http_uri; metadata:service http; reference:cve,2011-0570; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-user; sid:18440; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Acrobat and Acrobat Reader JPX malformed code-block width attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|6A 50 20 20|"; content:"|FF 4F FF 51|"; distance:0; byte_jump:2,36,relative,multiplier 3,big; content:"|FF 52 00 0C|"; within:4; byte_test:1,>,16,5,relative; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,35274; reference:bugtraq,35289; reference:cve,2009-1859; reference:url,www.adobe.com/support/security/bulletins/apsb09-07.html; classtype:attempted-user; sid:25767; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader known malicious variable exploit attempt"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"/OpenAction "; content:"/JS "; within:100; content:"ROP_ADD_ESP_4 = "; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2013-0640; reference:cve,2013-0641; reference:url,osvdb.org/90169; reference:url,www.adobe.com/support/security/advisories/apsa13-02.html; reference:url,www.adobe.com/support/security/bulletins/apsb13-07.html; classtype:attempted-admin; sid:25818; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Reader known malicious variable exploit attempt"; flow:established,to_server; flowbits:isset,file.pdf; file_data; content:"/OpenAction "; content:"/JS "; within:100; content:"|5C|n"; within:10; content:"|3B 5C|n"; within:30; fast_pattern; content:"|5C|n"; within:50; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2013-0640; reference:cve,2013-0641; reference:url,osvdb.org/90169; reference:url,www.adobe.com/support/security/advisories/apsa13-02.html; reference:url,www.adobe.com/support/security/bulletins/apsb13-07.html; classtype:attempted-admin; sid:25819; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Adobe Reader XML Java used in app.setTimeOut"; flow:established,to_client; flowbits:isset,file.pdf; file_data; content:"app.setTimeOut"; fast_pattern:only; content:"|2F|JavaScript"; content:"|2F|XFA"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,57931; reference:cve,2013-0640; reference:cve,2013-0641; reference:url,www.adobe.com/support/security/advisories/apsa13-02.html; reference:url,www.adobe.com/support/security/bulletins/apsb13-07.html; classtype:attempted-admin; sid:26021; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF EmbeddedFile contained within a PDF"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/EmbeddedFile"; fast_pattern:only; metadata:policy security-ips drop, service smtp; classtype:trojan-activity; sid:26022; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF PDF file with embedded PDF object"; flow:established,to_server; file_data; content:"EmbeddedFile"; nocase; content:"3C7064663E"; distance:0; nocase; content:"3C2F7064663E"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:26079; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-PDF Nuance PDF reader launch overflow attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/Launch"; distance:0; nocase; isdataat:1024,relative; content:!">>"; within:1024; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,osvdb.org/68514; classtype:attempted-admin; sid:26082; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF transfer of a PDF with OpenAction object attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/OpenAction"; distance:0; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*\x2fOpenAction/smi"; metadata:service smtp; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:26078; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF transfer of a PDF with embedded JavaScript - JavaScript string attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/JavaScript"; distance:0; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*\x2fJavaScript/smi"; metadata:service smtp; reference:cve,2013-0622; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:26077; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF download of a PDF with embedded JavaScript - JS string attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"obj"; nocase; content:"<<"; within:4; content:"/JS"; distance:0; fast_pattern; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*?\x2fJS[\s<>]/smi"; metadata:service smtp; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:26076; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-PDF Adobe Flash Player memory corruption attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"|63 2F 55 46 28 70 6F 63 2E 73 77 66 29 3E 3E 0D|"; content:"|3C 2F 43 68 65 63 6B 53 75 6D 3C 31 36 43 44 45 32 43 39 44 38 41 44 37 37 30 35 46 41 32 31 36 46 31 33 34 46 41 46 37 38 35 30 3E 2F 43 72 65|"; within:48; distance:112; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-0609; reference:url,www.adobe.com/support/security/bulletins/apsb11-06.html; classtype:attempted-user; sid:26113; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-PDF PDF version 1.1 with FlateDecode embedded - seen in exploit kits"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"%PDF-1.1"; content:"/FlateDecode"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:trojan-activity; sid:26231; rev:1;)
# alert tcp $EXTERNAL_NET [$HTTP_PORTS,6666] -> $HOME_NET any (msg:"FILE-PDF Foxit Reader remote query string buffer overflow attempt"; flow:to_client,established; content:".pdf?"; fast_pattern:only; content:"Location:"; offset:12; nocase; pcre:"/^Location\x3a\s*?[^\x2e]*?\.pdf\?[^\r\n]{512}/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,57174; reference:url,osvdb.org/89030; reference:url,retrogod.altervista.org/9sg_foxit_overflow.htm; classtype:attempted-user; sid:26282; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET [$HTTP_PORTS,6666] (msg:"FILE-PDF Foxit Reader remote query string buffer overflow attempt"; flow:to_server,established; content:".pdf?"; fast_pattern:only; pcre:"/^GET\s+?\x2f[^\x2e]*?\.pdf\?[^\r\n]{512}/i"; metadata:policy security-ips drop, service http; reference:bugtraq,57174; reference:url,osvdb.org/89030; reference:url,retrogod.altervista.org/9sg_foxit_overflow.htm; classtype:attempted-user; sid:26283; rev:1;)
# alert tcp $EXTERNAL_NET [$HTTP_PORTS,6666] -> $HOME_NET any (msg:"FILE-PDF Foxit Reader remote query string buffer overflow attempt"; flow:to_client,established; content:".pdf?"; fast_pattern:only; http_header; pcre:"/^Location\x3a[^\x2e]*?\.pdf\?[^\r\n]{512}/Him"; metadata:policy security-ips drop, service http; reference:bugtraq,57174; reference:url,osvdb.org/89030; reference:url,retrogod.altervista.org/9sg_foxit_overflow.htm; classtype:attempted-user; sid:26280; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET [$HTTP_PORTS,6666] (msg:"FILE-PDF Foxit Reader remote query string buffer overflow attempt"; flow:to_server,established; content:".pdf?"; fast_pattern:only; http_uri; pcre:"/^\x2f[^\x2e]*?\.pdf\?[^\r\n]{512}/Ui"; metadata:policy security-ips drop, service http; reference:bugtraq,57174; reference:url,osvdb.org/89030; reference:url,retrogod.altervista.org/9sg_foxit_overflow.htm; classtype:attempted-user; sid:26281; rev:1;)
