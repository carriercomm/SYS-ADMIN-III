# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2012 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2012 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#---------------
# EXPLOIT RULES
#---------------

# alert tcp $EXTERNAL_NET 21 -> $HOME_NET any (msg:"EXPLOIT NextFTP client overflow"; flow:to_client,established; content:"|B4| |B4|!|8B CC 83 E9 04 8B 19|3|C9|f|B9 10|"; metadata:ruleset community, service ftp; reference:bugtraq,572; reference:cve,1999-0671; classtype:attempted-user; sid:308; rev:13;)

# alert tcp $EXTERNAL_NET 22 -> $HOME_NET any (msg:"EXPLOIT SSH server banner overflow"; flow:to_client,established; content:"SSH-"; nocase; isdataat:200,relative; pcre:"/^SSH-\s?[^\n]{200}/ism"; metadata:ruleset community; reference:bugtraq,5287; reference:cve,2002-1059; reference:nessus,15822; classtype:misc-attack; sid:1838; rev:13;)
# alert tcp any any -> any 6666:7000 (msg:"EXPLOIT CHAT IRC Ettercap parse overflow attempt"; flow:to_server,established; content:"PRIVMSG"; fast_pattern:only; content:"nickserv"; nocase; content:"IDENTIFY"; nocase; isdataat:100,relative; pcre:"/^PRIVMSG\s+nickserv\s+IDENTIFY\s[^\n]{100}/smi"; metadata:ruleset community; reference:url,www.bugtraq.org/dev/GOBBLES-12.txt; classtype:misc-attack; sid:1382; rev:12;)
# alert udp any 4000 -> any any (msg:"EXPLOIT ICQ SRV_MULTI/SRV_META_USER overflow attempt - ISS Witty Worm"; flow:to_server; content:"|05 00|"; depth:2; content:"|12 02|"; within:2; distance:5; byte_test:1,>,1,12,relative; content:"|05 00|"; content:"n|00|"; within:2; distance:5; content:"|05 00|"; content:"|DE 03|"; within:2; distance:5; byte_test:2,>,512,-11,relative,little; metadata:ruleset community; reference:cve,2004-0362; reference:url,www.eeye.com/html/Research/Advisories/AD20040318.html; classtype:misc-attack; sid:2446; rev:14;)

# alert ip any any -> any any (msg:"EXPLOIT IGMP IGAP account overflow attempt"; ip_proto:2; byte_test:1,>,63,0; byte_test:1,<,67,0; byte_test:1,>,16,12; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2462; rev:9;)
# alert ip any any -> any any (msg:"EXPLOIT IGMP IGAP message overflow attempt"; ip_proto:2; byte_test:1,>,63,0; byte_test:1,<,67,0; byte_test:1,>,64,13; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2463; rev:9;)
# alert ip any any -> any any (msg:"EXPLOIT EIGRP prefix length overflow attempt"; ip_proto:88; byte_test:1,>,32,44; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2464; rev:9;)
# alert tcp $EXTERNAL_NET [80,8080] -> $HOME_NET any (msg:"EXPLOIT AIM goaway message buffer overflow attempt"; flow:to_client,established; file_data; content:"aim|3A|goaway?message="; nocase; isdataat:500,relative; pcre:"/\x22aim\x3Agoaway\x3Fmessage\x3D[^\x22]{500}|\x27aim\x3Agoaway\x3Fmessage\x3D[^\x27]{500}|aim\x3Agoaway\x3Fmessage\x3D[^\s]{500}/i"; reference:bugtraq,10889; reference:cve,2004-0636; classtype:misc-attack; sid:3085; rev:8;)

# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"EXPLOIT RSVP Protocol zero length object DoS attempt"; ip_proto:46; content:"|01|"; depth:1; offset:11; byte_test:1,<,4,13; pcre:"/^.{10}[\x14\x15]\x01.{1}[\x00-\x03]/sm"; reference:url,www.frsirt.com/english/advisories/2005/0411; classtype:attempted-dos; sid:4638; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"EXPLOIT YPOPS buffer overflow attempt"; flow:to_server,established; content:"|EB 06 92|F"; pcre:"/(\xeb\x08\x46\x92){49}/"; metadata:service smtp; reference:bugtraq,11256; reference:cve,2004-1558; classtype:attempted-admin; sid:8706; rev:5;)
# alert tcp $EXTERNAL_NET 22 -> $HOME_NET any (msg:"EXPLOIT Putty Server key exchange buffer overflow attempt"; flow:to_client,established,no_stream; content:"SSH-"; depth:4; isdataat:1000,relative; pcre:"/SSH-0*([2-9]\d*|1\d+)\.[^-]*-[^\n]*\n\x00\x00.{3}\x14.{1000}/s"; reference:bugtraq,6407; reference:cve,2002-1359; reference:url,www.rapid7.com/advisories/R7-0009.html; classtype:attempted-user; sid:10010; rev:6;)
# alert tcp $EXTERNAL_NET 5900 -> $HOME_NET any (msg:"EXPLOIT VNC password request buffer overflow attempt"; flow:to_client,established; content:"|00 00 00 00 00 00 04 06|"; depth:8; isdataat:1029,relative; reference:bugtraq,17378; reference:bugtraq,2305; reference:cve,2001-0167; reference:cve,2006-1652; classtype:web-application-attack; sid:10087; rev:2;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"EXPLOIT Cisco NHRP incorrect packet size"; ip_proto:47; content:" |01|"; depth:2; offset:2; content:"|FF FF|"; depth:2; offset:14; reference:bugtraq,25238; reference:cve,2007-4286; classtype:attempted-user; sid:12299; rev:3;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"EXPLOIT Cisco NHRP incorrect packet size"; ip_proto:54; content:"|FF FF|"; depth:2; offset:10; reference:bugtraq,25238; reference:cve,2007-4286; classtype:attempted-user; sid:12300; rev:3;)
# alert udp $EXTERNAL_NET 554 -> $HOME_NET any (msg:"EXPLOIT Apple Quicktime UDP RTSP sdp type buffer overflow attempt"; flow:to_client; content:"RTSP"; depth:4; fast_pattern; content:"Content-Type"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/Content-Type\s*\x3A[^\n\x3A]{256}/smi"; metadata:policy security-ips drop; reference:bugtraq,26549; reference:cve,2007-6166; classtype:attempted-user; sid:12742; rev:8;)
# alert tcp $EXTERNAL_NET 554 -> $HOME_NET any (msg:"EXPLOIT Apple Quicktime TCP RTSP sdp type buffer overflow attempt"; flow:to_client,established; content:"RTSP"; depth:4; fast_pattern; content:"Content-Type"; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/Content-Type\s*\x3A[^\n\x3A]{256}/smi"; reference:bugtraq,26549; reference:cve,2007-6166; classtype:attempted-user; sid:12741; rev:11;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT Skype skype4com URI handler memory corruption attempt"; flow:to_client,established; file_data; content:"skype4com|3A|"; fast_pattern:only; pcre:"/skype4com\x3A[A-Z\d]{0,6}[^A-Z\d]/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,26748; reference:cve,2007-5989; classtype:attempted-user; sid:13292; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT ClamAV MEW PE file integer overflow attempt"; flow:to_client,established; file_data; content:"MZ"; depth:2; content:"PE"; content:"MEW"; content:!"|00|"; within:1; distance:48; metadata:service http; reference:bugtraq,26927; reference:cve,2007-6335; classtype:attempted-user; sid:13362; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"EXPLOIT ClamAV MEW PE file integer overflow attempt"; flow:to_client,established; file_data; content:"MZ"; depth:2; content:"PE"; content:"MEW"; content:!"|00|"; within:1; distance:8; metadata:service http, service imap, service pop3; reference:bugtraq,26927; reference:cve,2007-6335; classtype:attempted-user; sid:13361; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT Apple QTIF malformed idsc atom"; flow:to_client,established; file_data; content:"idsc"; byte_test:4,<,94,-8,relative,big; metadata:service http; reference:cve,2008-0033; classtype:attempted-user; sid:13517; rev:5;)
alert tcp $EXTERNAL_NET [80,8090] -> $HOME_NET any (msg:"EXPLOIT Nullsoft Winamp Ultravox streaming malicious metadata"; flow:to_client,established; content:"misc/ultravox"; content:"<name>"; distance:0; nocase; isdataat:266,relative; content:!"</name>"; within:256; pcre:"/Content-Type\x3A\s*misc/ultravox.+?(\r?\n){2}\x5A.9\x01/is"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0065; classtype:attempted-user; sid:13521; rev:5;)
alert tcp $EXTERNAL_NET [80,8090] -> $HOME_NET any (msg:"EXPLOIT Nullsoft Winamp Ultravox streaming malicious metadata"; flow:to_client,established; content:"misc/ultravox"; http_header; file_data; content:"|5A|"; within:1; content:"|39 01|"; within:2; distance:1; content:"<artist>"; distance:0; nocase; isdataat:266,relative; content:!"</artist>"; within:256; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0065; classtype:attempted-user; sid:13520; rev:6;)
# alert tcp $EXTERNAL_NET 8300 -> $HOME_NET any (msg:"EXPLOIT Novell Groupwise HTTP response message parsing overflow"; flow:to_client,established; flowbits:isset,groupwise.request; isdataat:512; pcre:"/[^\x0a]{512}/"; metadata:service http; reference:cve,2008-2703; classtype:attempted-user; sid:13926; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT GNOME Project libxslt RC4 key string buffer overflow attempt"; flow:to_client,established; content:"Content-Type|3A|"; nocase; http_header; content:"text/xml"; within:20; nocase; http_header; content:"xsl|3A|transform"; fast_pattern:only; http_header; content:"crypto|3A|rc4_"; nocase; http_header; pcre:"/crypto\x3Arc4_(encrypt|decrypt)\x28\x27[^\x27]{129}/smiH"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30467; reference:cve,2008-2935; classtype:attempted-user; sid:14040; rev:10;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT GNOME Project libxslt RC4 key string buffer overflow attempt - 2"; flow:to_client,established; content:"Content-Type|3A|"; nocase; http_header; content:"text/xml"; nocase; http_header; content:"xsl|3A|version"; fast_pattern:only; http_header; content:"crypto|3A|rc4_"; nocase; http_header; pcre:"/crypto\x3Arc4_(encrypt|decrypt)\x28\x27[^\x27]{129}/smiH"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30467; reference:cve,2008-2935; classtype:attempted-user; sid:14041; rev:12;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT Skype URI handler input validation exploit attempt"; flow:to_client,established; file_data; content:"skype|3A|"; nocase; pcre:"/\x3Ca\s+[^\x3E]*href\s*\x3D\s*(\x22|\x27)?skype\x3A[^\s\x3E]*[\x01-\x07]/i"; metadata:policy security-ips drop, service http; reference:bugtraq,38699; reference:url,security-assessment.com/files/advisories/Skype_URI_Handling_Vulnerability.pdf; classtype:misc-attack; sid:16718; rev:5;)
# alert udp $EXTERNAL_NET 1604 -> $HOME_NET any (msg:"EXPLOIT Citrix Program Neighborhood Client buffer overflow attempt"; content:"|04 33|"; depth:2; offset:2; isdataat:292,relative; pcre:"/^.{36}([^\x00]{0,255}\x00)*[^\x00]{256}/isR"; reference:bugtraq,15907; reference:cve,2005-3652; classtype:attempted-user; sid:17326; rev:3;)
alert tcp $EXTERNAL_NET [5800,5900:5999] -> $HOME_NET any (msg:"EXPLOIT VNCViewer Authenticate buffer overflow attempt"; flow:to_client,established; flowbits:isset,vnc.auth; content:"|00 00 00|"; depth:3; content:"|7F FF FF FF|"; within:4; distance:1; pcre:"/^\x00{3}[\x00\x01]\x7f\xff{3}/m"; metadata:policy balanced-ips drop, policy security-ips drop, service vnc-server; reference:bugtraq,33568; reference:cve,2009-0388; classtype:attempted-user; sid:17397; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [5800,5900:5999] (msg:"EXPLOIT VNC client authentication response"; flow:to_server,established; content:"RFB 0"; depth:5; content:".0"; depth:2; offset:7; flowbits:set,vnc.auth; flowbits:noalert; metadata:service vnc-server; classtype:protocol-command-decode; sid:17396; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"EXPLOIT NOD32 Anti-Virus ARJ Archive Handling Buffer Overflow attempt"; flow:to_client,established; file_data; content:"|60 EA|"; depth:2; byte_jump:2,0,relative,little; content:"|60 EA|"; within:2; distance:6; byte_test:2,>,256,0,relative,little; metadata:service http, service imap, service pop3; reference:bugtraq,14773; reference:cve,2005-2903; classtype:attempted-admin; sid:17356; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT Oracle Java Applet2ClassLoader Remote Code Execution"; flow:to_client,established; file_data; content:"codebase|3D 22|file|3A|"; nocase; content:"code|3D 22|"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-4452; reference:url,exploit-db.com/exploits/16990/; classtype:attempted-user; sid:18679; rev:3;)
# alert udp $EXTERNAL_NET any -> 255.255.255.255 27155 (msg:"EXPLOIT GlobalSunTech Access Point Information Disclosure attempt"; flow:to_server; content:"gstsearch"; fast_pattern:only; metadata:ruleset community; reference:bugtraq,6100; classtype:misc-activity; sid:1966; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"EXPLOIT CA XOsoft Multiple Products entry_point.aspx buffer overflow attempt"; flow:to_server,established; content:"/entry_point.aspx"; nocase; http_uri; content:"txt_user_name_p|3D|"; nocase; isdataat:300,relative; pcre:"/txt_user_name_p\x3D[^\x26\x3F\x3B]{300}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39238; reference:cve,2010-1223; reference:url,support.ca.com/irj/portal/anonymous/phpsupcontent?contentID=232869; classtype:attempted-user; sid:19136; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT Alucar php shell download attempt"; flow:to_client,established; file_data; content:"dHA6Ly9YZ3IwdXBWbi5vcmc8L2E+IHwgPGEgaHJlZj0naHR0cDovL2hjZWdyb3VwLm5ldCc+SEBjaytDckBjaz1FbmoweSE8L2E+IHwgRGVzaWduIGJ5OkFsdUNhUiB8IF0t"; fast_pattern:only; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service http; reference:bugtraq,47374; reference:url,code.google.com/p/timthumb/issues/detail?id=212; classtype:attempted-user; sid:19661; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"EXPLOIT Trend Micro Control Manager CasLogDirectInsertHandler.cs cross site request forgery attempt"; flow:to_client,established; file_data; content:"SrcDataFile="; nocase; content:"|2E|xml"; distance:0; nocase; content:"SchemaFile="; nocase; content:"|2E|xml"; distance:0; nocase; content:"MsgType="; distance:0; nocase; metadata:service http; reference:url,esupport.trendmicro.com/solution/en-us/1058280.aspx; classtype:attempted-user; sid:20048; rev:2;)
alert tcp $EXTERNAL_NET [80,8090] -> $HOME_NET any (msg:"EXPLOIT Nullsoft Winamp Ultravox streaming malicious metadata"; flow:to_client,established; content:"misc/ultravox"; http_header; file_data; content:"|5A|"; within:1; content:"|39 01|"; within:2; distance:1; content:"<name>"; distance:0; nocase; isdataat:266,relative; content:!"</name>"; within:256; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2008-0065; classtype:attempted-user; sid:20110; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"EXPLOIT Oracle Java trusted method chaining attempt"; flow:to_client,established; file_data; content:"|50 4B 03 04|"; depth:4; content:"vuln/Link"; distance:0; nocase; metadata:service http, service imap, service pop3; reference:cve,2010-0840; classtype:attempted-user; sid:20529; rev:5;)
# alert tcp $EXTERNAL_NET 20031 -> $HOME_NET any (msg:"EXPLOIT BakBone NetVault client heap overflow attempt"; flow:to_client,established; stream_size:server,>,32784; byte_test:4,>,32784,0,little; reference:bugtraq,12967; reference:cve,2005-1009; classtype:attempted-admin; sid:20546; rev:2;)
# alert ip any any -> $HOME_NET any (msg:"EXPLOIT Ethereal IGAP Dissector Buffer Overflow attempt"; ip_proto:igmp; content:"A"; depth:1; byte_test:1,>,16,11,relative; reference:bugtraq,9952; reference:cve,2004-0176; reference:url,secunia.com/advisories/11185; classtype:attempted-admin; sid:20746; rev:2;)
# alert ip any any -> $HOME_NET any (msg:"EXPLOIT Ethereal IGAP Dissector Buffer Overflow attempt"; ip_proto:igmp; content:"A"; depth:1; byte_test:1,>,64,12,relative; reference:bugtraq,9952; reference:cve,2004-0176; reference:url,secunia.com/advisories/11185; classtype:attempted-admin; sid:20747; rev:2;)
# alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any (msg:"EXPLOIT Yahoo Messenger possible file transfer spoofing"; flow:established; content:"YMSG"; depth:4; content:"|00|M"; depth:2; offset:10; pcre:"/YMSG.{6}\x00\x4d.*?\x32\x37\xc0\x80(.{24,39}[\x2e\s])\.\w+\xc0\x80/i"; metadata:policy security-ips drop; reference:cve,2005-0243; classtype:attempted-user; sid:20748; rev:2;)
# alert tcp $EXTERNAL_NET 24800 -> $HOME_NET any (msg:"EXPLOIT Synergy clipboard format client integer overflow attempt"; flow:established,to_client; flowbits:isset,synergy; content:"DCLP"; pcre:"/^.{13}\x00\x00\x00[\x00\x01\x02]/R"; byte_test:4,>,3,9,big,relative; classtype:attempted-user; sid:21331; rev:1;)
# alert tcp $EXTERNAL_NET 24800 -> $HOME_NET any (msg:"EXPLOIT Synergy clipboard format client integer overflow attempt"; flow:established,to_client; flowbits:isset,synergy; content:"DCLP"; pcre:"/^.{9}\x00\x00\x00\x01(?!\x00\x00\x00[\x00\x01\x02])/R"; metadata:policy security-ips drop; classtype:attempted-user; sid:21329; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 6014 (msg:"EXPLOIT IBM Tivoli kuddb2 denial of service attempt"; flow:established,to_server; content:"|00 05 03 31 41|"; depth:5; reference:cve,2010-0472; classtype:attempted-dos; sid:21351; rev:1;)
# alert tcp $EXTERNAL_NET 110 -> $HOME_NET any (msg:"EXPLOIT Mortal Universe POP Peeper date header overflow attempt"; flow:to_client,established; content:"date: "; fast_pattern:only; pcre:"/Date\x3a\s+[^\x0d\x0a]{290}/i"; metadata:policy security-ips drop, service pop3; reference:cve,2009-1029; reference:url,exploit-db.com/exploits/8203/; classtype:attempted-user; sid:23404; rev:1;)
# alert udp $EXTERNAL_NET [67,68] -> $HOME_NET any (msg:"EXPLOIT Dhcpcd packet size buffer overflow attempt"; flow:to_server; dsize:>1456; content:"|02 01 06|"; depth:3; metadata:policy security-ips drop, service dhcp; reference:bugtraq,53354; reference:cve,2012-2152; classtype:attempted-admin; sid:23993; rev:2;)
